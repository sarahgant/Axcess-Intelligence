a709bfb3db353819923246219aebcbd3
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importDefault(require("react"));
const react_2 = require("@testing-library/react");
const ErrorBoundary_1 = require("../../src/components/ErrorBoundary");
const ScreenErrorBoundary_1 = require("../../src/components/ScreenErrorBoundary");
// Mock console.error to avoid noise in tests
const originalConsoleError = console.error;
beforeAll(() => {
    console.error = jest.fn();
});
afterAll(() => {
    console.error = originalConsoleError;
});
// Component that throws an error for testing
const ThrowError = ({ shouldThrow = false }) => {
    if (shouldThrow) {
        throw new Error('Test error message');
    }
    return (0, jsx_runtime_1.jsx)("div", { children: "Normal content" });
};
describe('ErrorBoundary', () => {
    beforeEach(() => {
        jest.clearAllMocks();
    });
    it('renders children when there is no error', () => {
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)("div", { children: "Test content" }) }));
        expect(react_2.screen.getByText('Test content')).toBeInTheDocument();
    });
    it('renders error fallback when child throws error', () => {
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('Something went wrong')).toBeInTheDocument();
        expect(react_2.screen.getByText('We encountered an unexpected error. Please try again or reload the page.')).toBeInTheDocument();
        expect(react_2.screen.getByText('Try Again')).toBeInTheDocument();
        expect(react_2.screen.getByText('Reload Page')).toBeInTheDocument();
    });
    it('calls onError callback when error occurs', () => {
        const onError = jest.fn();
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { onError: onError, children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(onError).toHaveBeenCalledWith(expect.any(Error), expect.objectContaining({
            componentStack: expect.any(String)
        }));
    });
    it('resets error state when Try Again is clicked', () => {
        const { rerender } = (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('Something went wrong')).toBeInTheDocument();
        // Click Try Again
        react_2.fireEvent.click(react_2.screen.getByText('Try Again'));
        // Re-render with no error
        rerender((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: false }) }));
        expect(react_2.screen.getByText('Normal content')).toBeInTheDocument();
    });
    it('reloads page when Reload Page is clicked', () => {
        const reloadMock = jest.fn();
        Object.defineProperty(window, 'location', {
            value: { reload: reloadMock },
            writable: true
        });
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        react_2.fireEvent.click(react_2.screen.getByText('Reload Page'));
        expect(reloadMock).toHaveBeenCalled();
    });
    it('renders custom fallback when provided', () => {
        const customFallback = (0, jsx_runtime_1.jsx)("div", { children: "Custom error message" });
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { fallback: customFallback, children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('Custom error message')).toBeInTheDocument();
        expect(react_2.screen.queryByText('Something went wrong')).not.toBeInTheDocument();
    });
    it('shows error details in development mode', () => {
        const originalEnv = process.env.NODE_ENV;
        process.env.NODE_ENV = 'development';
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('Error Details (Development)')).toBeInTheDocument();
        process.env.NODE_ENV = originalEnv;
    });
    it('does not show error details in production mode', () => {
        const originalEnv = process.env.NODE_ENV;
        process.env.NODE_ENV = 'production';
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.queryByText('Error Details (Development)')).not.toBeInTheDocument();
        process.env.NODE_ENV = originalEnv;
    });
});
describe('ScreenErrorBoundary', () => {
    beforeEach(() => {
        jest.clearAllMocks();
    });
    it('renders children when there is no error', () => {
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)("div", { children: "Screen content" }) }));
        expect(react_2.screen.getByText('Screen content')).toBeInTheDocument();
    });
    it('renders screen-specific error fallback when child throws error', () => {
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('TestScreen Error')).toBeInTheDocument();
        expect(react_2.screen.getByText('We encountered an issue with the TestScreen screen. You can try again or return to the home screen.')).toBeInTheDocument();
        expect(react_2.screen.getByText('Try Again')).toBeInTheDocument();
        expect(react_2.screen.getByText('Go to Home')).toBeInTheDocument();
    });
    it('calls onError callback when error occurs', () => {
        const onError = jest.fn();
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", onError: onError, children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(onError).toHaveBeenCalledWith(expect.any(Error), expect.objectContaining({
            componentStack: expect.any(String)
        }));
    });
    it('resets error state when Try Again is clicked', () => {
        const { rerender } = (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('TestScreen Error')).toBeInTheDocument();
        // Click Try Again
        react_2.fireEvent.click(react_2.screen.getByText('Try Again'));
        // Re-render with no error
        rerender((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: false }) }));
        expect(react_2.screen.getByText('Normal content')).toBeInTheDocument();
    });
    it('navigates to home when Go to Home is clicked', () => {
        const locationMock = jest.fn();
        Object.defineProperty(window, 'location', {
            value: { href: locationMock },
            writable: true
        });
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        react_2.fireEvent.click(react_2.screen.getByText('Go to Home'));
        expect(window.location.href).toBe('/');
    });
    it('logs screen-specific error information', () => {
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(console.error).toHaveBeenCalledWith('Screen Error Boundary (TestScreen):', expect.objectContaining({
            error: expect.any(String),
            componentStack: expect.any(String),
            screenName: 'TestScreen',
            timestamp: expect.any(String),
            url: expect.any(String)
        }));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxzYXJhaFxcUmVwb3NcXENDSCBBeGNlc3MgSW50ZWxsaWdlbmNlIFZpYmVkXFx0ZXN0c1xcdW5pdFxcRXJyb3JCb3VuZGFyeS50ZXN0LnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxrREFBMEI7QUFDMUIsa0RBQW1FO0FBQ25FLHNFQUFtRTtBQUNuRSxrRkFBK0U7QUFFL0UsNkNBQTZDO0FBQzdDLE1BQU0sb0JBQW9CLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQztBQUMzQyxTQUFTLENBQUMsR0FBRyxFQUFFO0lBQ1gsT0FBTyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFDOUIsQ0FBQyxDQUFDLENBQUM7QUFFSCxRQUFRLENBQUMsR0FBRyxFQUFFO0lBQ1YsT0FBTyxDQUFDLEtBQUssR0FBRyxvQkFBb0IsQ0FBQztBQUN6QyxDQUFDLENBQUMsQ0FBQztBQUVILDZDQUE2QztBQUM3QyxNQUFNLFVBQVUsR0FBRyxDQUFDLEVBQUUsV0FBVyxHQUFHLEtBQUssRUFBNkIsRUFBRSxFQUFFO0lBQ3RFLElBQUksV0FBVyxFQUFFLENBQUM7UUFDZCxNQUFNLElBQUksS0FBSyxDQUFDLG9CQUFvQixDQUFDLENBQUM7SUFDMUMsQ0FBQztJQUNELE9BQU8sNkRBQXlCLENBQUM7QUFDckMsQ0FBQyxDQUFDO0FBRUYsUUFBUSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7SUFDM0IsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN6QixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx5Q0FBeUMsRUFBRSxHQUFHLEVBQUU7UUFDL0MsSUFBQSxjQUFNLEVBQ0YsdUJBQUMsNkJBQWEsY0FDViwyREFBdUIsR0FDWCxDQUNuQixDQUFDO1FBRUYsTUFBTSxDQUFDLGNBQU0sQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO0lBQ2pFLENBQUMsQ0FBQyxDQUFD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QWMsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQztZQUNsQyxVQUFVLEVBQUUsWUFBWTtZQUN4QixTQUFTLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUM7WUFDN0IsR0FBRyxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDO1NBQzFCLENBQUMsQ0FDTCxDQUFDO0lBQ04sQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNhcmFoXFxSZXBvc1xcQ0NIIEF4Y2VzcyBJbnRlbGxpZ2VuY2UgVmliZWRcXHRlc3RzXFx1bml0XFxFcnJvckJvdW5kYXJ5LnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcclxuaW1wb3J0IHsgRXJyb3JCb3VuZGFyeSB9IGZyb20gJy4uLy4uL3NyYy9jb21wb25lbnRzL0Vycm9yQm91bmRhcnknO1xyXG5pbXBvcnQgeyBTY3JlZW5FcnJvckJvdW5kYXJ5IH0gZnJvbSAnLi4vLi4vc3JjL2NvbXBvbmVudHMvU2NyZWVuRXJyb3JCb3VuZGFyeSc7XHJcblxyXG4vLyBNb2NrIGNvbnNvbGUuZXJyb3IgdG8gYXZvaWQgbm9pc2UgaW4gdGVzdHNcclxuY29uc3Qgb3JpZ2luYWxDb25zb2xlRXJyb3IgPSBjb25zb2xlLmVycm9yO1xyXG5iZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvciA9IGplc3QuZm4oKTtcclxufSk7XHJcblxyXG5hZnRlckFsbCgoKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yID0gb3JpZ2luYWxDb25zb2xlRXJyb3I7XHJcbn0pO1xyXG5cclxuLy8gQ29tcG9uZW50IHRoYXQgdGhyb3dzIGFuIGVycm9yIGZvciB0ZXN0aW5nXHJcbmNvbnN0IFRocm93RXJyb3IgPSAoeyBzaG91bGRUaHJvdyA9IGZhbHNlIH06IHsgc2hvdWxkVGhyb3c/OiBib29sZWFuIH0pID0+IHtcclxuICAgIGlmIChzaG91bGRUaHJvdykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGVzdCBlcnJvciBtZXNzYWdlJyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gPGRpdj5Ob3JtYWwgY29udGVudDwvZGl2PjtcclxufTtcclxuXHJcbmRlc2NyaWJlKCdFcnJvckJvdW5kYXJ5JywgKCkgPT4ge1xyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncmVuZGVycyBjaGlsZHJlbiB3aGVuIHRoZXJlIGlzIG5vIGVycm9yJywgKCkgPT4ge1xyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPEVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgICAgICAgICA8ZGl2PlRlc3QgY29udGVudDwvZGl2PlxyXG4gICAgICAgICAgICA8L0Vycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1Rlc3QgY29udGVudCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3JlbmRlcnMgZXJyb3IgZmFsbGJhY2sgd2hlbiBjaGlsZCB0aHJvd3MgZXJyb3InLCAoKSA9PiB7XHJcbiAgICAgICAgcmVuZGVyKFxyXG4gICAgICAgICAgICA8RXJyb3JCb3VuZGFyeT5cclxuICAgICAgICAgICAgICAgIDxUaHJvd0Vycm9yIHNob3VsZFRocm93PXt0cnVlfSAvPlxyXG4gICAgICAgICAgICA8L0Vycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NvbWV0aGluZyB3ZW50IHdyb25nJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1dlIGVuY291bnRlcmVkIGFuIHVuZXhwZWN0ZWQgZXJyb3IuIFBsZWFzZSB0cnkgYWdhaW4gb3IgcmVsb2FkIHRoZSBwYWdlLicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdUcnkgQWdhaW4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnUmVsb2FkIFBhZ2UnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdjYWxscyBvbkVycm9yIGNhbGxiYWNrIHdoZW4gZXJyb3Igb2NjdXJzJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG9uRXJyb3IgPSBqZXN0LmZuKCk7XHJcblxyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPEVycm9yQm91bmRhcnkgb25FcnJvcj17b25FcnJvcn0+XHJcbiAgICAgICAgICAgICAgICA8VGhyb3dFcnJvciBzaG91bGRUaHJvdz17dHJ1ZX0gLz5cclxuICAgICAgICAgICAgPC9FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChvbkVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICAgICAgZXhwZWN0LmFueShFcnJvciksXHJcbiAgICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudFN0YWNrOiBleHBlY3QuYW55KFN0cmluZylcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Jlc2V0cyBlcnJvciBzdGF0ZSB3aGVuIFRyeSBBZ2FpbiBpcyBjbGlja2VkJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgcmVyZW5kZXIgfSA9IHJlbmRlcihcclxuICAgICAgICAgICAgPEVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgICAgICAgICA8VGhyb3dFcnJvciBzaG91bGRUaHJvdz17dHJ1ZX0gLz5cclxuICAgICAgICAgICAgPC9FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTb21ldGhpbmcgd2VudCB3cm9uZycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG5cclxuICAgICAgICAvLyBDbGljayBUcnkgQWdhaW5cclxuICAgICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnVHJ5IEFnYWluJykpO1xyXG5cclxuICAgICAgICAvLyBSZS1yZW5kZXIgd2l0aCBubyBlcnJvclxyXG4gICAgICAgIHJlcmVuZGVyKFxyXG4gICAgICAgICAgICA8RXJyb3JCb3VuZGFyeT5cclxuICAgICAgICAgICAgICAgIDxUaHJvd0Vycm9yIHNob3VsZFRocm93PXtmYWxzZX0gLz5cclxuICAgICAgICAgICAgPC9FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdOb3JtYWwgY29udGVudCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3JlbG9hZHMgcGFnZSB3aGVuIFJlbG9hZCBQYWdlIGlzIGNsaWNrZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcmVsb2FkTW9jayA9IGplc3QuZm4oKTtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAnbG9jYXRpb24nLCB7XHJcbiAgICAgICAgICAgIHZhbHVlOiB7IHJlbG9hZDogcmVsb2FkTW9jayB9LFxyXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZW5kZXIoXHJcbiAgICAgICAgICAgIDxFcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICAgICAgICAgPFRocm93RXJyb3Igc2hvdWxkVGhyb3c9e3RydWV9IC8+XHJcbiAgICAgICAgICAgIDwvRXJyb3JCb3VuZGFyeT5cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnUmVsb2FkIFBhZ2UnKSk7XHJcbiAgICAgICAgZXhwZWN0KHJlbG9hZE1vY2spLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdyZW5kZXJzIGN1c3RvbSBmYWxsYmFjayB3aGVuIHByb3ZpZGVkJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGN1c3RvbUZhbGxiYWNrID0gPGRpdj5DdXN0b20gZXJyb3IgbWVzc2FnZTwvZGl2PjtcclxuXHJcbiAgICAgICAgcmVuZGVyKFxyXG4gICAgICAgICAgICA8RXJyb3JCb3VuZGFyeSBmYWxsYmFjaz17Y3VzdG9tRmFsbGJhY2t9PlxyXG4gICAgICAgICAgICAgICAgPFRocm93RXJyb3Igc2hvdWxkVGhyb3c9e3RydWV9IC8+XHJcbiAgICAgICAgICAgIDwvRXJyb3JCb3VuZGFyeT5cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQ3VzdG9tIGVycm9yIG1lc3NhZ2UnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlUZXh0KCdTb21ldGhpbmcgd2VudCB3cm9uZycpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG93cyBlcnJvciBkZXRhaWxzIGluIGRldmVsb3BtZW50IG1vZGUnLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgb3JpZ2luYWxFbnYgPSBwcm9jZXNzLmVudi5OT0RFX0VOVjtcclxuICAgICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICdkZXZlbG9wbWVudCc7XHJcblxyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPEVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgICAgICAgICA8VGhyb3dFcnJvciBzaG91bGRUaHJvdz17dHJ1ZX0gLz5cclxuICAgICAgICAgICAgPC9FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdFcnJvciBEZXRhaWxzIChEZXZlbG9wbWVudCknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuXHJcbiAgICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSBvcmlnaW5hbEVudjtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkb2VzIG5vdCBzaG93IGVycm9yIGRldGFpbHMgaW4gcHJvZHVjdGlvbiBtb2RlJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsRW52ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlY7XHJcbiAgICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAncHJvZHVjdGlvbic7XHJcblxyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPEVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgICAgICAgICA8VGhyb3dFcnJvciBzaG91bGRUaHJvdz17dHJ1ZX0gLz5cclxuICAgICAgICAgICAgPC9FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeVRleHQoJ0Vycm9yIERldGFpbHMgKERldmVsb3BtZW50KScpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuXHJcbiAgICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSBvcmlnaW5hbEVudjtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmRlc2NyaWJlKCdTY3JlZW5FcnJvckJvdW5kYXJ5JywgKCkgPT4ge1xyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncmVuZGVycyBjaGlsZHJlbiB3aGVuIHRoZXJlIGlzIG5vIGVycm9yJywgKCkgPT4ge1xyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPFNjcmVlbkVycm9yQm91bmRhcnkgc2NyZWVuTmFtZT1cIlRlc3RTY3JlZW5cIj5cclxuICAgICAgICAgICAgICAgIDxkaXY+U2NyZWVuIGNvbnRlbnQ8L2Rpdj5cclxuICAgICAgICAgICAgPC9TY3JlZW5FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTY3JlZW4gY29udGVudCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3JlbmRlcnMgc2NyZWVuLXNwZWNpZmljIGVycm9yIGZhbGxiYWNrIHdoZW4gY2hpbGQgdGhyb3dzIGVycm9yJywgKCkgPT4ge1xyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPFNjcmVlbkVycm9yQm91bmRhcnkgc2NyZWVuTmFtZT1cIlRlc3RTY3JlZW5cIj5cclxuICAgICAgICAgICAgICAgIDxUaHJvd0Vycm9yIHNob3VsZFRocm93PXt0cnVlfSAvPlxyXG4gICAgICAgICAgICA8L1NjcmVlbkVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1Rlc3RTY3JlZW4gRXJyb3InKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnV2UgZW5jb3VudGVyZWQgYW4gaXNzdWUgd2l0aCB0aGUgVGVzdFNjcmVlbiBzY3JlZW4uIFlvdSBjYW4gdHJ5IGFnYWluIG9yIHJldHVybiB0byB0aGUgaG9tZSBzY3JlZW4uJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1RyeSBBZ2FpbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdHbyB0byBIb21lJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnY2FsbHMgb25FcnJvciBjYWxsYmFjayB3aGVuIGVycm9yIG9jY3VycycsICgpID0+IHtcclxuICAgICAgICBjb25zdCBvbkVycm9yID0gamVzdC5mbigpO1xyXG5cclxuICAgICAgICByZW5kZXIoXHJcbiAgICAgICAgICAgIDxTY3JlZW5FcnJvckJvdW5kYXJ5IHNjcmVlbk5hbWU9XCJUZXN0U2NyZWVuXCIgb25FcnJvcj17b25FcnJvcn0+XHJcbiAgICAgICAgICAgICAgICA8VGhyb3dFcnJvciBzaG91bGRUaHJvdz17dHJ1ZX0gLz5cclxuICAgICAgICAgICAgPC9TY3JlZW5FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChvbkVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICAgICAgZXhwZWN0LmFueShFcnJvciksXHJcbiAgICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudFN0YWNrOiBleHBlY3QuYW55KFN0cmluZylcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Jlc2V0cyBlcnJvciBzdGF0ZSB3aGVuIFRyeSBBZ2FpbiBpcyBjbGlja2VkJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgcmVyZW5kZXIgfSA9IHJlbmRlcihcclxuICAgICAgICAgICAgPFNjcmVlbkVycm9yQm91bmRhcnkgc2NyZWVuTmFtZT1cIlRlc3RTY3JlZW5cIj5cclxuICAgICAgICAgICAgICAgIDxUaHJvd0Vycm9yIHNob3VsZFRocm93PXt0cnVlfSAvPlxyXG4gICAgICAgICAgICA8L1NjcmVlbkVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1Rlc3RTY3JlZW4gRXJyb3InKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuXHJcbiAgICAgICAgLy8gQ2xpY2sgVHJ5IEFnYWluXHJcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJ1RyeSBBZ2FpbicpKTtcclxuXHJcbiAgICAgICAgLy8gUmUtcmVuZGVyIHdpdGggbm8gZXJyb3JcclxuICAgICAgICByZXJlbmRlcihcclxuICAgICAgICAgICAgPFNjcmVlbkVycm9yQm91bmRhcnkgc2NyZWVuTmFtZT1cIlRlc3RTY3JlZW5cIj5cclxuICAgICAgICAgICAgICAgIDxUaHJvd0Vycm9yIHNob3VsZFRocm93PXtmYWxzZX0gLz5cclxuICAgICAgICAgICAgPC9TY3JlZW5FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdOb3JtYWwgY29udGVudCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ25hdmlnYXRlcyB0byBob21lIHdoZW4gR28gdG8gSG9tZSBpcyBjbGlja2VkJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGxvY2F0aW9uTW9jayA9IGplc3QuZm4oKTtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAnbG9jYXRpb24nLCB7XHJcbiAgICAgICAgICAgIHZhbHVlOiB7IGhyZWY6IGxvY2F0aW9uTW9jayB9LFxyXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZW5kZXIoXHJcbiAgICAgICAgICAgIDxTY3JlZW5FcnJvckJvdW5kYXJ5IHNjcmVlbk5hbWU9XCJUZXN0U2NyZWVuXCI+XHJcbiAgICAgICAgICAgICAgICA8VGhyb3dFcnJvciBzaG91bGRUaHJvdz17dHJ1ZX0gLz5cclxuICAgICAgICAgICAgPC9TY3JlZW5FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCdHbyB0byBIb21lJykpO1xyXG4gICAgICAgIGV4cGVjdCh3aW5kb3cubG9jYXRpb24uaHJlZikudG9CZSgnLycpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2xvZ3Mgc2NyZWVuLXNwZWNpZmljIGVycm9yIGluZm9ybWF0aW9uJywgKCkgPT4ge1xyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPFNjcmVlbkVycm9yQm91bmRhcnkgc2NyZWVuTmFtZT1cIlRlc3RTY3JlZW5cIj5cclxuICAgICAgICAgICAgICAgIDxUaHJvd0Vycm9yIHNob3VsZFRocm93PXt0cnVlfSAvPlxyXG4gICAgICAgICAgICA8L1NjcmVlbkVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZXhwZWN0KGNvbnNvbGUuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgICAgICAnU2NyZWVuIEVycm9yIEJvdW5kYXJ5IChUZXN0U2NyZWVuKTonLFxyXG4gICAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZXhwZWN0LmFueShTdHJpbmcpLFxyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50U3RhY2s6IGV4cGVjdC5hbnkoU3RyaW5nKSxcclxuICAgICAgICAgICAgICAgIHNjcmVlbk5hbWU6ICdUZXN0U2NyZWVuJyxcclxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogZXhwZWN0LmFueShTdHJpbmcpLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBleHBlY3QuYW55KFN0cmluZylcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=