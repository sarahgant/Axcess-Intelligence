{"version":3,"names":["require","getTreeDiff","cssPointerEvents","shared","buttons","_define_property","obj","key","value","Object","defineProperty","enumerable","configurable","writable","Pointer","init","instance","target","getTarget","enter","getEventInit","assertPointerEvents","dispatchUIEvent","forEach","el","move","position","prevPosition","prevTarget","isDifferentPointerPosition","nextTarget","leave","hasPointerEvents","down","button","isDown","isPrevented","up","release","isCancelled","_this_position_target","undefined","config","document","body","coords","pointerId","pointerType","isPrimary","getMouseEventButton","getButtons","constructor","isMultitouch","exports"],"sources":["pointer.js"],"sourcesContent":["'use strict';\n\nrequire('../../utils/dataTransfer/Clipboard.js');\nvar getTreeDiff = require('../../utils/misc/getTreeDiff.js');\nvar cssPointerEvents = require('../../utils/pointer/cssPointerEvents.js');\nvar shared = require('./shared.js');\nvar buttons = require('./buttons.js');\n\nfunction _define_property(obj, key, value) {\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true\n        });\n    } else {\n        obj[key] = value;\n    }\n    return obj;\n}\nclass Pointer {\n    init(instance) {\n        const target = this.getTarget(instance);\n        const [, enter] = getTreeDiff.getTreeDiff(null, target);\n        const init = this.getEventInit();\n        cssPointerEvents.assertPointerEvents(instance, target);\n        instance.dispatchUIEvent(target, 'pointerover', init);\n        enter.forEach((el)=>instance.dispatchUIEvent(el, 'pointerenter', init));\n        return this;\n    }\n    move(instance, position) {\n        const prevPosition = this.position;\n        const prevTarget = this.getTarget(instance);\n        this.position = position;\n        if (!shared.isDifferentPointerPosition(prevPosition, position)) {\n            return;\n        }\n        const nextTarget = this.getTarget(instance);\n        const init = this.getEventInit(-1);\n        const [leave, enter] = getTreeDiff.getTreeDiff(prevTarget, nextTarget);\n        return {\n            leave: ()=>{\n                if (cssPointerEvents.hasPointerEvents(instance, prevTarget)) {\n                    if (prevTarget !== nextTarget) {\n                        instance.dispatchUIEvent(prevTarget, 'pointerout', init);\n                        leave.forEach((el)=>instance.dispatchUIEvent(el, 'pointerleave', init));\n                    }\n                }\n            },\n            enter: ()=>{\n                cssPointerEvents.assertPointerEvents(instance, nextTarget);\n                if (prevTarget !== nextTarget) {\n                    instance.dispatchUIEvent(nextTarget, 'pointerover', init);\n                    enter.forEach((el)=>instance.dispatchUIEvent(el, 'pointerenter', init));\n                }\n            },\n            move: ()=>{\n                instance.dispatchUIEvent(nextTarget, 'pointermove', init);\n            }\n        };\n    }\n    down(instance, button = 0) {\n        if (this.isDown) {\n            return;\n        }\n        const target = this.getTarget(instance);\n        cssPointerEvents.assertPointerEvents(instance, target);\n        this.isDown = true;\n        this.isPrevented = !instance.dispatchUIEvent(target, 'pointerdown', this.getEventInit(button));\n    }\n    up(instance, button = 0) {\n        if (!this.isDown) {\n            return;\n        }\n        const target = this.getTarget(instance);\n        cssPointerEvents.assertPointerEvents(instance, target);\n        this.isPrevented = false;\n        this.isDown = false;\n        instance.dispatchUIEvent(target, 'pointerup', this.getEventInit(button));\n    }\n    release(instance) {\n        const target = this.getTarget(instance);\n        const [leave] = getTreeDiff.getTreeDiff(target, null);\n        const init = this.getEventInit();\n        // Currently there is no PointerEventsCheckLevel that would\n        // make this check not use the *asserted* cached value from `up`.\n        /* istanbul ignore else */ if (cssPointerEvents.hasPointerEvents(instance, target)) {\n            instance.dispatchUIEvent(target, 'pointerout', init);\n            leave.forEach((el)=>instance.dispatchUIEvent(el, 'pointerleave', init));\n        }\n        this.isCancelled = true;\n    }\n    getTarget(instance) {\n        var _this_position_target;\n        return (_this_position_target = this.position.target) !== null && _this_position_target !== undefined ? _this_position_target : instance.config.document.body;\n    }\n    getEventInit(/**\n     * The `button` that caused the event.\n     *\n     * This should be `-1` if the event is not caused by a button or touch/pen contact,\n     * e.g. a moving pointer.\n     */ button) {\n        return {\n            ...this.position.coords,\n            pointerId: this.pointerId,\n            pointerType: this.pointerType,\n            isPrimary: this.isPrimary,\n            button: buttons.getMouseEventButton(button),\n            buttons: this.buttons.getButtons()\n        };\n    }\n    constructor({ pointerId, pointerType, isPrimary }, buttons){\n        _define_property(this, \"pointerId\", undefined);\n        _define_property(this, \"pointerType\", undefined);\n        _define_property(this, \"isPrimary\", undefined);\n        _define_property(this, \"buttons\", undefined);\n        _define_property(this, \"isMultitouch\", false);\n        _define_property(this, \"isCancelled\", false);\n        _define_property(this, \"isDown\", false);\n        _define_property(this, \"isPrevented\", false);\n        _define_property(this, \"position\", {});\n        this.pointerId = pointerId;\n        this.pointerType = pointerType;\n        this.isPrimary = isPrimary;\n        this.isMultitouch = !isPrimary;\n        this.buttons = buttons;\n    }\n}\n\nexports.Pointer = Pointer;\n"],"mappings":"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","ignoreList":[]}