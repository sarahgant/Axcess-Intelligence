{"version":3,"names":["dom","require","isElementType","isDisabled","wait","cssPointerEvents","focus","selectOptions","select","values","selectOptionsBase","call","deselectOptions","newValue","multiple","getConfig","getElementError","valArray","Array","isArray","allOptions","from","querySelectorAll","selectedOptions","map","val","includes","matchingOption","find","o","value","innerHTML","String","filter","option","length","selectOption","selected","dispatchUIEvent","bubbles","cancelable","composed","withPointerEvents","config","pointerEventsCheck","hasPointerEvents","focusElement","click","getAttribute","unhover","exports"],"sources":["selectOptions.js"],"sourcesContent":["'use strict';\n\nvar dom = require('@testing-library/dom');\nvar isElementType = require('../utils/misc/isElementType.js');\nrequire('../utils/dataTransfer/Clipboard.js');\nvar isDisabled = require('../utils/misc/isDisabled.js');\nvar wait = require('../utils/misc/wait.js');\nvar cssPointerEvents = require('../utils/pointer/cssPointerEvents.js');\nrequire('../event/behavior/click.js');\nrequire('../event/behavior/cut.js');\nrequire('../event/behavior/keydown.js');\nrequire('../event/behavior/keypress.js');\nrequire('../event/behavior/keyup.js');\nrequire('../event/behavior/paste.js');\nvar focus = require('../event/focus.js');\n\nasync function selectOptions(select, values) {\n    return selectOptionsBase.call(this, true, select, values);\n}\nasync function deselectOptions(select, values) {\n    return selectOptionsBase.call(this, false, select, values);\n}\nasync function selectOptionsBase(newValue, select, values) {\n    if (!newValue && !select.multiple) {\n        throw dom.getConfig().getElementError(`Unable to deselect an option in a non-multiple select. Use selectOptions to change the selection instead.`, select);\n    }\n    const valArray = Array.isArray(values) ? values : [\n        values\n    ];\n    const allOptions = Array.from(select.querySelectorAll('option, [role=\"option\"]'));\n    const selectedOptions = valArray.map((val)=>{\n        if (typeof val !== 'string' && allOptions.includes(val)) {\n            return val;\n        } else {\n            const matchingOption = allOptions.find((o)=>o.value === val || o.innerHTML === val);\n            if (matchingOption) {\n                return matchingOption;\n            } else {\n                throw dom.getConfig().getElementError(`Value \"${String(val)}\" not found in options`, select);\n            }\n        }\n    }).filter((option)=>!isDisabled.isDisabled(option));\n    if (isDisabled.isDisabled(select) || !selectedOptions.length) return;\n    const selectOption = (option)=>{\n        option.selected = newValue;\n        this.dispatchUIEvent(select, 'input', {\n            bubbles: true,\n            cancelable: false,\n            composed: true\n        });\n        this.dispatchUIEvent(select, 'change');\n    };\n    if (isElementType.isElementType(select, 'select')) {\n        if (select.multiple) {\n            for (const option of selectedOptions){\n                const withPointerEvents = this.config.pointerEventsCheck === 0 ? true : cssPointerEvents.hasPointerEvents(this, option);\n                // events fired for multiple select are weird. Can't use hover...\n                if (withPointerEvents) {\n                    this.dispatchUIEvent(option, 'pointerover');\n                    this.dispatchUIEvent(select, 'pointerenter');\n                    this.dispatchUIEvent(option, 'mouseover');\n                    this.dispatchUIEvent(select, 'mouseenter');\n                    this.dispatchUIEvent(option, 'pointermove');\n                    this.dispatchUIEvent(option, 'mousemove');\n                    this.dispatchUIEvent(option, 'pointerdown');\n                    this.dispatchUIEvent(option, 'mousedown');\n                }\n                focus.focusElement(select);\n                if (withPointerEvents) {\n                    this.dispatchUIEvent(option, 'pointerup');\n                    this.dispatchUIEvent(option, 'mouseup');\n                }\n                selectOption(option);\n                if (withPointerEvents) {\n                    this.dispatchUIEvent(option, 'click');\n                }\n                await wait.wait(this.config);\n            }\n        } else if (selectedOptions.length === 1) {\n            const withPointerEvents = this.config.pointerEventsCheck === 0 ? true : cssPointerEvents.hasPointerEvents(this, select);\n            // the click to open the select options\n            if (withPointerEvents) {\n                await this.click(select);\n            } else {\n                focus.focusElement(select);\n            }\n            selectOption(selectedOptions[0]);\n            if (withPointerEvents) {\n                // the browser triggers another click event on the select for the click on the option\n                // this second click has no 'down' phase\n                this.dispatchUIEvent(select, 'pointerover');\n                this.dispatchUIEvent(select, 'pointerenter');\n                this.dispatchUIEvent(select, 'mouseover');\n                this.dispatchUIEvent(select, 'mouseenter');\n                this.dispatchUIEvent(select, 'pointerup');\n                this.dispatchUIEvent(select, 'mouseup');\n                this.dispatchUIEvent(select, 'click');\n            }\n            await wait.wait(this.config);\n        } else {\n            throw dom.getConfig().getElementError(`Cannot select multiple options on a non-multiple select`, select);\n        }\n    } else if (select.getAttribute('role') === 'listbox') {\n        for (const option of selectedOptions){\n            await this.click(option);\n            await this.unhover(option);\n        }\n    } else {\n        throw dom.getConfig().getElementError(`Cannot select options on elements that are neither select nor listbox elements`, select);\n    }\n}\n\nexports.deselectOptions = deselectOptions;\nexports.selectOptions = selectOptions;\n"],"mappings":"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","ignoreList":[]}