073a26d75e631d920e4797b23f1593fa
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.ChatMessage = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const React = __importStar(require("react"));
const utils_1 = require("../../lib/utils");
const ChatMessage = ({ message, isUser, isStreaming = false, citations = [], timestamp, onCopy, onFeedback, feedbackValue, }) => {
    const [showCopyToast, setShowCopyToast] = React.useState(false);
    // Handle copy to clipboard
    const handleCopy = async () => {
        try {
            await navigator.clipboard.writeText(message);
            onCopy?.();
            setShowCopyToast(true);
            setTimeout(() => setShowCopyToast(false), 2000);
        }
        catch (error) {
            console.error("Failed to copy message:", error);
        }
    };
    // Handle feedback
    const handleFeedback = (type) => {
        onFeedback?.(type);
    };
    // Process message with citations
    const processMessageWithCitations = (text) => {
        if (citations.length === 0)
            return text;
        let processedText = text;
        citations.forEach((citation, index) => {
            const citationPlaceholder = `[${index + 1}]`;
            const citationLink = ((0, jsx_runtime_1.jsx)("a", { href: citation.url, target: "_blank", rel: "noopener noreferrer", className: "text-blue-600 underline hover:text-blue-800 font-medium", title: `Source: ${citation.text}`, children: citation.text }, index));
            // Note: This is a simplified implementation. In a real app, you'd want to use a proper
            // text processing library to handle citation replacement with React elements
        });
        return processedText;
    };
    return ((0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("flex w-full mb-4", isUser ? "justify-end" : "justify-start"), role: "region", "aria-label": isUser ? "Your message" : "AI assistant message", children: (0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)("max-w-[85%] rounded-lg px-4 py-3 text-sm", isUser
                ? "bg-primary text-primary-foreground ml-auto"
                : "bg-muted text-muted-foreground mr-auto"), children: [(0, jsx_runtime_1.jsxs)("div", { className: "whitespace-pre-wrap break-words", children: [processMessageWithCitations(message), isStreaming && ((0, jsx_runtime_1.jsx)("span", { className: "inline-block w-2 h-4 ml-1 bg-current animate-pulse" }))] }), citations.length > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "mt-3 pt-3 border-t border-border/20", children: [(0, jsx_runtime_1.jsx)("div", { className: "text-xs font-medium mb-2 opacity-75", children: "Sources:" }), (0, jsx_runtime_1.jsx)("div", { className: "space-y-1", children: citations.map((citation, index) => ((0, jsx_runtime_1.jsx)("div", { children: (0, jsx_runtime_1.jsx)("a", { href: citation.url, target: "_blank", rel: "noopener noreferrer", className: "text-blue-600 underline hover:text-blue-800 text-xs font-medium", children: citation.text }) }, index))) })] })), timestamp && ((0, jsx_runtime_1.jsx)("div", { className: "mt-2 text-xs opacity-50", children: timestamp.toLocaleTimeString([], {
                        hour: "2-digit",
                        minute: "2-digit"
                    }) })), !isUser && !isStreaming && ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 mt-3 pt-3 border-t border-border/20", children: [(0, jsx_runtime_1.jsxs)("button", { onClick: handleCopy, className: "inline-flex items-center gap-1 px-2 py-1 text-xs rounded hover:bg-background/50 transition-colors", "aria-label": "Copy message", children: [(0, jsx_runtime_1.jsx)("svg", { className: "w-3 h-3", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: (0, jsx_runtime_1.jsx)("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" }) }), "Copy"] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-1", children: [(0, jsx_runtime_1.jsx)("button", { onClick: () => handleFeedback("up"), className: (0, utils_1.cn)("inline-flex items-center p-1 rounded hover:bg-background/50 transition-colors", feedbackValue === "up" && "text-green-600"), "aria-label": "Thumbs up", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-3 h-3", fill: feedbackValue === "up" ? "currentColor" : "none", stroke: "currentColor", viewBox: "0 0 24 24", children: (0, jsx_runtime_1.jsx)("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V8a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5" }) }) }), (0, jsx_runtime_1.jsx)("button", { onClick: () => handleFeedback("down"), className: (0, utils_1.cn)("inline-flex items-center p-1 rounded hover:bg-background/50 transition-colors", feedbackValue === "down" && "text-red-600"), "aria-label": "Thumbs down", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-3 h-3", fill: feedbackValue === "down" ? "currentColor" : "none", stroke: "currentColor", viewBox: "0 0 24 24", children: (0, jsx_runtime_1.jsx)("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M10 14H5.236a2 2 0 01-1.789-2.894l3.5-7A2 2 0 018.736 3h4.018c.163 0 .326.02.485.06L17 4m-7 10v2a2 2 0 002 2h.095c.5 0 .905-.405.905-.905 0-.714.211-1.412.608-2.006L17 13V4m-7 10h2M17 4h2a2 2 0 012 2v6a2 2 0 01-2 2h-2.5" }) }) })] })] })), showCopyToast && ((0, jsx_runtime_1.jsx)("div", { className: "absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-full mt-2 px-3 py-1 bg-gray-900 text-white text-xs rounded shadow-lg", children: "Copied to clipboard" }))] }) }));
};
exports.ChatMessage = ChatMessage;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxzYXJhaFxcUmVwb3NcXENDSCBBeGNlc3MgSW50ZWxsaWdlbmNlIFZpYmVkXFxzcmNcXGNvbXBvbmVudHNcXHVpXFxjaGF0LW1lc3NhZ2UudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSw2Q0FBK0I7QUFDL0IsMkNBQXFDO0FBZ0JyQyxNQUFNLFdBQVcsR0FBK0IsQ0FBQyxFQUMvQyxPQUFPLEVBQ1AsTUFBTSxFQUNOLFdBQVcsR0FBRyxLQUFLLEVBQ25CLFNBQVMsR0FBRyxFQUFFLEVBQ2QsU0FBUyxFQUNULE1BQU0sRUFDTixVQUFVLEVBQ1YsYUFBYSxHQUNkLEVBQUUsRUFBRTtJQUNILE1BQU0sQ0FBQyxhQUFhLEVBQUUsZ0JBQWdCLENBQUMsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBRWhFLDJCQUEyQjtJQUMzQixNQUFNLFVBQVUsR0FBRyxLQUFLLElBQUksRUFBRTtRQUM1QixJQUFJLENBQUM7WUFDSCxNQUFNLFNBQVMsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQzdDLE1BQU0sRUFBRSxFQUFFLENBQUM7WUFDWCxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN2QixVQUFVLENBQUMsR0FBRyxFQUFFLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDbEQsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixPQUFPLENBQUMsS0FBSyxDQUFDLHlCQUF5QixFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ2xELENBQUM7SUFDSCxDQUFDLENBQUM7SUFFRixrQkFBa0I7SUFDbEIsTUFBTSxjQUFjLEdBQUcsQ0FBQyxJQUFtQixFQUFFLEVBQUU7UUFDN0MsVUFBVSxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDckIsQ0FBQyxDQUFDO0lBRUYsaUNBQWlDO0lBQ2pDLE1BQU0sMkJBQTJC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WyJDOlxcVXNlcnNcXHNhcmFoXFxSZXBvc1xcQ0NIIEF4Y2VzcyBJbnRlbGxpZ2VuY2UgVmliZWRcXHNyY1xcY29tcG9uZW50c1xcdWlcXGNoYXQtbWVzc2FnZS50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCB7IGNuIH0gZnJvbSBcIi4uLy4uL2xpYi91dGlsc1wiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDaGF0TWVzc2FnZVByb3BzIHtcclxuICBtZXNzYWdlOiBzdHJpbmc7XHJcbiAgaXNVc2VyOiBib29sZWFuO1xyXG4gIGlzU3RyZWFtaW5nPzogYm9vbGVhbjtcclxuICBjaXRhdGlvbnM/OiBBcnJheTx7XHJcbiAgICB0ZXh0OiBzdHJpbmc7XHJcbiAgICB1cmw6IHN0cmluZztcclxuICB9PjtcclxuICB0aW1lc3RhbXA/OiBEYXRlO1xyXG4gIG9uQ29weT86ICgpID0+IHZvaWQ7XHJcbiAgb25GZWVkYmFjaz86ICh0eXBlOiBcInVwXCIgfCBcImRvd25cIikgPT4gdm9pZDtcclxuICBmZWVkYmFja1ZhbHVlPzogXCJ1cFwiIHwgXCJkb3duXCIgfCBudWxsO1xyXG59XHJcblxyXG5jb25zdCBDaGF0TWVzc2FnZTogUmVhY3QuRkM8Q2hhdE1lc3NhZ2VQcm9wcz4gPSAoe1xyXG4gIG1lc3NhZ2UsXHJcbiAgaXNVc2VyLFxyXG4gIGlzU3RyZWFtaW5nID0gZmFsc2UsXHJcbiAgY2l0YXRpb25zID0gW10sXHJcbiAgdGltZXN0YW1wLFxyXG4gIG9uQ29weSxcclxuICBvbkZlZWRiYWNrLFxyXG4gIGZlZWRiYWNrVmFsdWUsXHJcbn0pID0+IHtcclxuICBjb25zdCBbc2hvd0NvcHlUb2FzdCwgc2V0U2hvd0NvcHlUb2FzdF0gPSBSZWFjdC51c2VTdGF0ZShmYWxzZSk7XHJcblxyXG4gIC8vIEhhbmRsZSBjb3B5IHRvIGNsaXBib2FyZFxyXG4gIGNvbnN0IGhhbmRsZUNvcHkgPSBhc3luYyAoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChtZXNzYWdlKTtcclxuICAgICAgb25Db3B5Py4oKTtcclxuICAgICAgc2V0U2hvd0NvcHlUb2FzdCh0cnVlKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiBzZXRTaG93Q29weVRvYXN0KGZhbHNlKSwgMjAwMCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNvcHkgbWVzc2FnZTpcIiwgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vIEhhbmRsZSBmZWVkYmFja1xyXG4gIGNvbnN0IGhhbmRsZUZlZWRiYWNrID0gKHR5cGU6IFwidXBcIiB8IFwiZG93blwiKSA9PiB7XHJcbiAgICBvbkZlZWRiYWNrPy4odHlwZSk7XHJcbiAgfTtcclxuXHJcbiAgLy8gUHJvY2VzcyBtZXNzYWdlIHdpdGggY2l0YXRpb25zXHJcbiAgY29uc3QgcHJvY2Vzc01lc3NhZ2VXaXRoQ2l0YXRpb25zID0gKHRleHQ6IHN0cmluZykgPT4ge1xyXG4gICAgaWYgKGNpdGF0aW9ucy5sZW5ndGggPT09IDApIHJldHVybiB0ZXh0O1xyXG4gICAgXHJcbiAgICBsZXQgcHJvY2Vzc2VkVGV4dCA9IHRleHQ7XHJcbiAgICBjaXRhdGlvbnMuZm9yRWFjaCgoY2l0YXRpb24sIGluZGV4KSA9PiB7XHJcbiAgICAgIGNvbnN0IGNpdGF0aW9uUGxhY2Vob2xkZXIgPSBgWyR7aW5kZXggKyAxfV1gO1xyXG4gICAgICBjb25zdCBjaXRhdGlvbkxpbmsgPSAoXHJcbiAgICAgICAgPGFcclxuICAgICAgICAgIGtleT17aW5kZXh9XHJcbiAgICAgICAgICBocmVmPXtjaXRhdGlvbi51cmx9XHJcbiAgICAgICAgICB0YXJnZXQ9XCJfYmxhbmtcIlxyXG4gICAgICAgICAgcmVsPVwibm9vcGVuZXIgbm9yZWZlcnJlclwiXHJcbiAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXh0LWJsdWUtNjAwIHVuZGVybGluZSBob3Zlcjp0ZXh0LWJsdWUtODAwIGZvbnQtbWVkaXVtXCJcclxuICAgICAgICAgIHRpdGxlPXtgU291cmNlOiAke2NpdGF0aW9uLnRleHR9YH1cclxuICAgICAgICA+XHJcbiAgICAgICAgICB7Y2l0YXRpb24udGV4dH1cclxuICAgICAgICA8L2E+XHJcbiAgICAgICk7XHJcbiAgICAgIC8vIE5vdGU6IFRoaXMgaXMgYSBzaW1wbGlmaWVkIGltcGxlbWVudGF0aW9uLiBJbiBhIHJlYWwgYXBwLCB5b3UnZCB3YW50IHRvIHVzZSBhIHByb3BlclxyXG4gICAgICAvLyB0ZXh0IHByb2Nlc3NpbmcgbGlicmFyeSB0byBoYW5kbGUgY2l0YXRpb24gcmVwbGFjZW1lbnQgd2l0aCBSZWFjdCBlbGVtZW50c1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiBwcm9jZXNzZWRUZXh0O1xyXG4gIH07XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2XHJcbiAgICAgIGNsYXNzTmFtZT17Y24oXHJcbiAgICAgICAgXCJmbGV4IHctZnVsbCBtYi00XCIsXHJcbiAgICAgICAgaXNVc2VyID8gXCJqdXN0aWZ5LWVuZFwiIDogXCJqdXN0aWZ5LXN0YXJ0XCJcclxuICAgICAgKX1cclxuICAgICAgcm9sZT1cInJlZ2lvblwiXHJcbiAgICAgIGFyaWEtbGFiZWw9e2lzVXNlciA/IFwiWW91ciBtZXNzYWdlXCIgOiBcIkFJIGFzc2lzdGFudCBtZXNzYWdlXCJ9XHJcbiAgICA+XHJcbiAgICAgIDxkaXZcclxuICAgICAgICBjbGFzc05hbWU9e2NuKFxyXG4gICAgICAgICAgXCJtYXgtdy1bODUlXSByb3VuZGVkLWxnIHB4LTQgcHktMyB0ZXh0LXNtXCIsXHJcbiAgICAgICAgICBpc1VzZXJcclxuICAgICAgICAgICAgPyBcImJnLXByaW1hcnkgdGV4dC1wcmltYXJ5LWZvcmVncm91bmQgbWwtYXV0b1wiXHJcbiAgICAgICAgICAgIDogXCJiZy1tdXRlZCB0ZXh0LW11dGVkLWZvcmVncm91bmQgbXItYXV0b1wiXHJcbiAgICAgICAgKX1cclxuICAgICAgPlxyXG4gICAgICAgIHsvKiBNZXNzYWdlIGNvbnRlbnQgKi99XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3aGl0ZXNwYWNlLXByZS13cmFwIGJyZWFrLXdvcmRzXCI+XHJcbiAgICAgICAgICB7cHJvY2Vzc01lc3NhZ2VXaXRoQ2l0YXRpb25zKG1lc3NhZ2UpfVxyXG4gICAgICAgICAge2lzU3RyZWFtaW5nICYmIChcclxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaW5saW5lLWJsb2NrIHctMiBoLTQgbWwtMSBiZy1jdXJyZW50IGFuaW1hdGUtcHVsc2VcIiAvPlxyXG4gICAgICAgICAgKX1cclxuICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgey8qIENpdGF0aW9ucyAqL31cclxuICAgICAgICB7Y2l0YXRpb25zLmxlbmd0aCA+IDAgJiYgKFxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC0zIHB0LTMgYm9yZGVyLXQgYm9yZGVyLWJvcmRlci8yMFwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQteHMgZm9udC1tZWRpdW0gbWItMiBvcGFjaXR5LTc1XCI+U291cmNlczo8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTFcIj5cclxuICAgICAgICAgICAgICB7Y2l0YXRpb25zLm1hcCgoY2l0YXRpb24sIGluZGV4KSA9PiAoXHJcbiAgICAgICAgICAgICAgICA8ZGl2IGtleT17aW5kZXh9PlxyXG4gICAgICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgICAgIGhyZWY9e2NpdGF0aW9uLnVybH1cclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ9XCJfYmxhbmtcIlxyXG4gICAgICAgICAgICAgICAgICAgIHJlbD1cIm5vb3BlbmVyIG5vcmVmZXJyZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRleHQtYmx1ZS02MDAgdW5kZXJsaW5lIGhvdmVyOnRleHQtYmx1ZS04MDAgdGV4dC14cyBmb250LW1lZGl1bVwiXHJcbiAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICB7Y2l0YXRpb24udGV4dH1cclxuICAgICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgKSl9XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKX1cclxuXHJcbiAgICAgICAgey8qIFRpbWVzdGFtcCAqL31cclxuICAgICAgICB7dGltZXN0YW1wICYmIChcclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtMiB0ZXh0LXhzIG9wYWNpdHktNTBcIj5cclxuICAgICAgICAgICAge3RpbWVzdGFtcC50b0xvY2FsZVRpbWVTdHJpbmcoW10sIHsgXHJcbiAgICAgICAgICAgICAgaG91cjogXCIyLWRpZ2l0XCIsIFxyXG4gICAgICAgICAgICAgIG1pbnV0ZTogXCIyLWRpZ2l0XCIgXHJcbiAgICAgICAgICAgIH0pfVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKX1cclxuXHJcbiAgICAgICAgey8qIEFjdGlvbiBidXR0b25zIGZvciBBSSBtZXNzYWdlcyAqL31cclxuICAgICAgICB7IWlzVXNlciAmJiAhaXNTdHJlYW1pbmcgJiYgKFxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBtdC0zIHB0LTMgYm9yZGVyLXQgYm9yZGVyLWJvcmRlci8yMFwiPlxyXG4gICAgICAgICAgICB7LyogQ29weSBidXR0b24gKi99XHJcbiAgICAgICAgICAgIDxidXR0b25cclxuICAgICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVDb3B5fVxyXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImlubGluZS1mbGV4IGl0ZW1zLWNlbnRlciBnYXAtMSBweC0yIHB5LTEgdGV4dC14cyByb3VuZGVkIGhvdmVyOmJnLWJhY2tncm91bmQvNTAgdHJhbnNpdGlvbi1jb2xvcnNcIlxyXG4gICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJDb3B5IG1lc3NhZ2VcIlxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgPHN2Z1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy0zIGgtM1wiXHJcbiAgICAgICAgICAgICAgICBmaWxsPVwibm9uZVwiXHJcbiAgICAgICAgICAgICAgICBzdHJva2U9XCJjdXJyZW50Q29sb3JcIlxyXG4gICAgICAgICAgICAgICAgdmlld0JveD1cIjAgMCAyNCAyNFwiXHJcbiAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgPHBhdGhcclxuICAgICAgICAgICAgICAgICAgc3Ryb2tlTGluZWNhcD1cInJvdW5kXCJcclxuICAgICAgICAgICAgICAgICAgc3Ryb2tlTGluZWpvaW49XCJyb3VuZFwiXHJcbiAgICAgICAgICAgICAgICAgIHN0cm9rZVdpZHRoPXsyfVxyXG4gICAgICAgICAgICAgICAgICBkPVwiTTggMTZINmEyIDIgMCAwMS0yLTJWNmEyIDIgMCAwMTItMmg4YTIgMiAwIDAxMiAydjJtLTYgMTJoOGEyIDIgMCAwMDItMnYtOGEyIDIgMCAwMC0yLTJoLThhMiAyIDAgMDAtMiAydjhhMiAyIDAgMDAyIDJ6XCJcclxuICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICAgICAgQ29weVxyXG4gICAgICAgICAgICA8L2J1dHRvbj5cclxuXHJcbiAgICAgICAgICAgIHsvKiBGZWVkYmFjayBidXR0b25zICovfVxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0xXCI+XHJcbiAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlRmVlZGJhY2soXCJ1cFwiKX1cclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y24oXHJcbiAgICAgICAgICAgICAgICAgIFwiaW5saW5lLWZsZXggaXRlbXMtY2VudGVyIHAtMSByb3VuZGVkIGhvdmVyOmJnLWJhY2tncm91bmQvNTAgdHJhbnNpdGlvbi1jb2xvcnNcIixcclxuICAgICAgICAgICAgICAgICAgZmVlZGJhY2tWYWx1ZSA9PT0gXCJ1cFwiICYmIFwidGV4dC1ncmVlbi02MDBcIlxyXG4gICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJUaHVtYnMgdXBcIlxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxzdmdcclxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy0zIGgtM1wiXHJcbiAgICAgICAgICAgICAgICAgIGZpbGw9e2ZlZWRiYWNrVmFsdWUgPT09IFwidXBcIiA/IFwiY3VycmVudENvbG9yXCIgOiBcIm5vbmVcIn1cclxuICAgICAgICAgICAgICAgICAgc3Ryb2tlPVwiY3VycmVudENvbG9yXCJcclxuICAgICAgICAgICAgICAgICAgdmlld0JveD1cIjAgMCAyNCAyNFwiXHJcbiAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgIDxwYXRoXHJcbiAgICAgICAgICAgICAgICAgICAgc3Ryb2tlTGluZWNhcD1cInJvdW5kXCJcclxuICAgICAgICAgICAgICAgICAgICBzdHJva2VMaW5lam9pbj1cInJvdW5kXCJcclxuICAgICAgICAgICAgICAgICAgICBzdHJva2VXaWR0aD17Mn1cclxuICAgICAgICAgICAgICAgICAgICBkPVwiTTE0IDEwaDQuNzY0YTIgMiAwIDAxMS43ODkgMi44OTRsLTMuNSA3QTIgMiAwIDAxMTUuMjYzIDIxaC00LjAxN2MtLjE2MyAwLS4zMjYtLjAyLS40ODUtLjA2TDcgMjBtNy0xMFY4YTIgMiAwIDAwLTItMmgtLjA5NWMtLjUgMC0uOTA1LjQwNS0uOTA1LjkwNSAwIC43MTQtLjIxMSAxLjQxMi0uNjA4IDIuMDA2TDcgMTF2OW03LTEwaC0yTTcgMjBINWEyIDIgMCAwMS0yLTJ2LTZhMiAyIDAgMDEyLTJoMi41XCJcclxuICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIDxidXR0b25cclxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUZlZWRiYWNrKFwiZG93blwiKX1cclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y24oXHJcbiAgICAgICAgICAgICAgICAgIFwiaW5saW5lLWZsZXggaXRlbXMtY2VudGVyIHAtMSByb3VuZGVkIGhvdmVyOmJnLWJhY2tncm91bmQvNTAgdHJhbnNpdGlvbi1jb2xvcnNcIixcclxuICAgICAgICAgICAgICAgICAgZmVlZGJhY2tWYWx1ZSA9PT0gXCJkb3duXCIgJiYgXCJ0ZXh0LXJlZC02MDBcIlxyXG4gICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJUaHVtYnMgZG93blwiXHJcbiAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgPHN2Z1xyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTMgaC0zXCJcclxuICAgICAgICAgICAgICAgICAgZmlsbD17ZmVlZGJhY2tWYWx1ZSA9PT0gXCJkb3duXCIgPyBcImN1cnJlbnRDb2xvclwiIDogXCJub25lXCJ9XHJcbiAgICAgICAgICAgICAgICAgIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiXHJcbiAgICAgICAgICAgICAgICAgIHZpZXdCb3g9XCIwIDAgMjQgMjRcIlxyXG4gICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICA8cGF0aFxyXG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZUxpbmVjYXA9XCJyb3VuZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgc3Ryb2tlTGluZWpvaW49XCJyb3VuZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg9ezJ9XHJcbiAgICAgICAgICAgICAgICAgICAgZD1cIk0xMCAxNEg1LjIzNmEyIDIgMCAwMS0xLjc4OS0yLjg5NGwzLjUtN0EyIDIgMCAwMTguNzM2IDNoNC4wMThjLjE2MyAwIC4zMjYuMDIuNDg1LjA2TDE3IDRtLTcgMTB2MmEyIDIgMCAwMDIgMmguMDk1Yy41IDAgLjkwNS0uNDA1LjkwNS0uOTA1IDAtLjcxNC4yMTEtMS40MTIuNjA4LTIuMDA2TDE3IDEzVjRtLTcgMTBoMk0xNyA0aDJhMiAyIDAgMDEyIDJ2NmEyIDIgMCAwMS0yIDJoLTIuNVwiXHJcbiAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICA8L3N2Zz5cclxuICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApfVxyXG5cclxuICAgICAgICB7LyogQ29weSBzdWNjZXNzIHRvYXN0ICovfVxyXG4gICAgICAgIHtzaG93Q29weVRvYXN0ICYmIChcclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWJzb2x1dGUgYm90dG9tLTAgbGVmdC0xLzIgdHJhbnNmb3JtIC10cmFuc2xhdGUteC0xLzIgdHJhbnNsYXRlLXktZnVsbCBtdC0yIHB4LTMgcHktMSBiZy1ncmF5LTkwMCB0ZXh0LXdoaXRlIHRleHQteHMgcm91bmRlZCBzaGFkb3ctbGdcIj5cclxuICAgICAgICAgICAgQ29waWVkIHRvIGNsaXBib2FyZFxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKX1cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICApO1xyXG59O1xyXG5cclxuZXhwb3J0IHsgQ2hhdE1lc3NhZ2UgfTtcclxuZXhwb3J0IHR5cGUgeyBDaGF0TWVzc2FnZVByb3BzIH07Il0sInZlcnNpb24iOjN9