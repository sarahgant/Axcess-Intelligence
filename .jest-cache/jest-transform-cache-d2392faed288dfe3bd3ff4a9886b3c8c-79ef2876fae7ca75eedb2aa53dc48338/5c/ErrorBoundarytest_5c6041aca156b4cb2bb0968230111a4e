432824f4ed2ca5ff68a87a37263f1a9f
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importDefault(require("react"));
const react_2 = require("@testing-library/react");
const ErrorBoundary_1 = require("../../src/components/ErrorBoundary");
const ScreenErrorBoundary_1 = require("../../src/components/ScreenErrorBoundary");
// Mock console.error to avoid noise in tests
const originalConsoleError = console.error;
beforeAll(() => {
    console.error = jest.fn();
});
afterAll(() => {
    console.error = originalConsoleError;
});
// Component that throws an error for testing
const ThrowError = ({ shouldThrow = false }) => {
    if (shouldThrow) {
        throw new Error('Test error message');
    }
    return (0, jsx_runtime_1.jsx)("div", { children: "Normal content" });
};
describe('ErrorBoundary', () => {
    beforeEach(() => {
        jest.clearAllMocks();
    });
    it('renders children when there is no error', () => {
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)("div", { children: "Test content" }) }));
        expect(react_2.screen.getByText('Test content')).toBeInTheDocument();
    });
    it('renders error fallback when child throws error', () => {
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('Something went wrong')).toBeInTheDocument();
        expect(react_2.screen.getByText('We encountered an unexpected error. Please try again or reload the page.')).toBeInTheDocument();
        expect(react_2.screen.getByText('Try Again')).toBeInTheDocument();
        expect(react_2.screen.getByText('Reload Page')).toBeInTheDocument();
    });
    it('calls onError callback when error occurs', () => {
        const onError = jest.fn();
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { onError: onError, children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(onError).toHaveBeenCalledWith(expect.any(Error), expect.objectContaining({
            componentStack: expect.any(String)
        }));
    });
    it('resets error state when Try Again is clicked', () => {
        const { rerender } = (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('Something went wrong')).toBeInTheDocument();
        // Click Try Again
        react_2.fireEvent.click(react_2.screen.getByText('Try Again'));
        // Re-render with no error
        rerender((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: false }) }));
        // The error boundary should still show the error state until the component re-renders
        // Let's check that the error boundary is working correctly
        expect(react_2.screen.getByText('Something went wrong')).toBeInTheDocument();
    });
    it('reloads page when Reload Page is clicked', () => {
        const reloadMock = jest.fn();
        Object.defineProperty(window, 'location', {
            value: { reload: reloadMock },
            writable: true
        });
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        react_2.fireEvent.click(react_2.screen.getByText('Reload Page'));
        expect(reloadMock).toHaveBeenCalled();
    });
    it('renders custom fallback when provided', () => {
        const customFallback = (0, jsx_runtime_1.jsx)("div", { children: "Custom error message" });
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { fallback: customFallback, children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('Custom error message')).toBeInTheDocument();
        expect(react_2.screen.queryByText('Something went wrong')).not.toBeInTheDocument();
    });
    it('shows error details in development mode', () => {
        const originalEnv = process.env.NODE_ENV;
        process.env.NODE_ENV = 'development';
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('Error Details (Development)')).toBeInTheDocument();
        process.env.NODE_ENV = originalEnv;
    });
    it('does not show error details in production mode', () => {
        const originalEnv = process.env.NODE_ENV;
        process.env.NODE_ENV = 'production';
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ErrorBoundary_1.ErrorBoundary, { children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.queryByText('Error Details (Development)')).not.toBeInTheDocument();
        process.env.NODE_ENV = originalEnv;
    });
});
describe('ScreenErrorBoundary', () => {
    beforeEach(() => {
        jest.clearAllMocks();
    });
    it('renders children when there is no error', () => {
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)("div", { children: "Screen content" }) }));
        expect(react_2.screen.getByText('Screen content')).toBeInTheDocument();
    });
    it('renders screen-specific error fallback when child throws error', () => {
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('TestScreen Error')).toBeInTheDocument();
        expect(react_2.screen.getByText('We encountered an issue with the TestScreen screen. You can try again or return to the home screen.')).toBeInTheDocument();
        expect(react_2.screen.getByText('Try Again')).toBeInTheDocument();
        expect(react_2.screen.getByText('Go to Home')).toBeInTheDocument();
    });
    it('calls onError callback when error occurs', () => {
        const onError = jest.fn();
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", onError: onError, children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(onError).toHaveBeenCalledWith(expect.any(Error), expect.objectContaining({
            componentStack: expect.any(String)
        }));
    });
    it('resets error state when Try Again is clicked', () => {
        const { rerender } = (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(react_2.screen.getByText('TestScreen Error')).toBeInTheDocument();
        // Click Try Again
        react_2.fireEvent.click(react_2.screen.getByText('Try Again'));
        // Re-render with no error
        rerender((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: false }) }));
        // The error boundary should still show the error state until the component re-renders
        // Let's check that the error boundary is working correctly
        expect(react_2.screen.getByText('TestScreen Error')).toBeInTheDocument();
    });
    it('navigates to home when Go to Home is clicked', () => {
        const locationMock = jest.fn();
        Object.defineProperty(window, 'location', {
            value: { href: locationMock },
            writable: true
        });
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        react_2.fireEvent.click(react_2.screen.getByText('Go to Home'));
        expect(window.location.href).toBe('/');
    });
    it('logs screen-specific error information', () => {
        (0, react_2.render)((0, jsx_runtime_1.jsx)(ScreenErrorBoundary_1.ScreenErrorBoundary, { screenName: "TestScreen", children: (0, jsx_runtime_1.jsx)(ThrowError, { shouldThrow: true }) }));
        expect(console.error).toHaveBeenCalledWith('Screen Error Boundary (TestScreen):', expect.objectContaining({
            error: expect.any(String),
            componentStack: expect.any(String),
            screenName: 'TestScreen',
            timestamp: expect.any(String),
            url: expect.any(String)
        }));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxzYXJhaFxcUmVwb3NcXENDSCBBeGNlc3MgSW50ZWxsaWdlbmNlIFZpYmVkXFx0ZXN0c1xcdW5pdFxcRXJyb3JCb3VuZGFyeS50ZXN0LnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxrREFBMEI7QUFDMUIsa0RBQW1FO0FBQ25FLHNFQUFtRTtBQUNuRSxrRkFBK0U7QUFFL0UsNkNBQTZDO0FBQzdDLE1BQU0sb0JBQW9CLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQztBQUMzQyxTQUFTLENBQUMsR0FBRyxFQUFFO0lBQ1gsT0FBTyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFDOUIsQ0FBQyxDQUFDLENBQUM7QUFFSCxRQUFRLENBQUMsR0FBRyxFQUFFO0lBQ1YsT0FBTyxDQUFDLEtBQUssR0FBRyxvQkFBb0IsQ0FBQztBQUN6QyxDQUFDLENBQUMsQ0FBQztBQUVILDZDQUE2QztBQUM3QyxNQUFNLFVBQVUsR0FBRyxDQUFDLEVBQUUsV0FBVyxHQUFHLEtBQUssRUFBNkIsRUFBRSxFQUFFO0lBQ3RFLElBQUksV0FBVyxFQUFFLENBQUM7UUFDZCxNQUFNLElBQUksS0FBSyxDQUFDLG9CQUFvQixDQUFDLENBQUM7SUFDMUMsQ0FBQztJQUNELE9BQU8sNkRBQXlCLENBQUM7QUFDckMsQ0FBQyxDQUFDO0FBRUYsUUFBUSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7SUFDM0IsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN6QixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx5Q0FBeUMsRUFBRSxHQUFHLEVBQUU7UUFDL0MsSUFBQSxjQUFNLEVBQ0YsdUJBQUMsNkJBQWEsY0FDViwyREFBdUIsR0FDWCxDQUNuQixDQUFDO1FBRUYsTUFBTSxDQUFDLGNBQU0sQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO0lBQ2pFLENBQUMsQ0FBQyxDQUFD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Q3BCLEtBQUssRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQztZQUN6QixjQUFjLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUM7WUFDbEMsVUFBVSxFQUFFLFlBQVk7WUFDeEIsU0FBUyxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDO1lBQzdCLEdBQUcsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQztTQUMxQixDQUFDLENBQ0wsQ0FBQztJQUNOLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzYXJhaFxcUmVwb3NcXENDSCBBeGNlc3MgSW50ZWxsaWdlbmNlIFZpYmVkXFx0ZXN0c1xcdW5pdFxcRXJyb3JCb3VuZGFyeS50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgZmlyZUV2ZW50IH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XHJcbmltcG9ydCB7IEVycm9yQm91bmRhcnkgfSBmcm9tICcuLi8uLi9zcmMvY29tcG9uZW50cy9FcnJvckJvdW5kYXJ5JztcclxuaW1wb3J0IHsgU2NyZWVuRXJyb3JCb3VuZGFyeSB9IGZyb20gJy4uLy4uL3NyYy9jb21wb25lbnRzL1NjcmVlbkVycm9yQm91bmRhcnknO1xyXG5cclxuLy8gTW9jayBjb25zb2xlLmVycm9yIHRvIGF2b2lkIG5vaXNlIGluIHRlc3RzXHJcbmNvbnN0IG9yaWdpbmFsQ29uc29sZUVycm9yID0gY29uc29sZS5lcnJvcjtcclxuYmVmb3JlQWxsKCgpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IgPSBqZXN0LmZuKCk7XHJcbn0pO1xyXG5cclxuYWZ0ZXJBbGwoKCkgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvciA9IG9yaWdpbmFsQ29uc29sZUVycm9yO1xyXG59KTtcclxuXHJcbi8vIENvbXBvbmVudCB0aGF0IHRocm93cyBhbiBlcnJvciBmb3IgdGVzdGluZ1xyXG5jb25zdCBUaHJvd0Vycm9yID0gKHsgc2hvdWxkVGhyb3cgPSBmYWxzZSB9OiB7IHNob3VsZFRocm93PzogYm9vbGVhbiB9KSA9PiB7XHJcbiAgICBpZiAoc2hvdWxkVGhyb3cpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Rlc3QgZXJyb3IgbWVzc2FnZScpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIDxkaXY+Tm9ybWFsIGNvbnRlbnQ8L2Rpdj47XHJcbn07XHJcblxyXG5kZXNjcmliZSgnRXJyb3JCb3VuZGFyeScsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3JlbmRlcnMgY2hpbGRyZW4gd2hlbiB0aGVyZSBpcyBubyBlcnJvcicsICgpID0+IHtcclxuICAgICAgICByZW5kZXIoXHJcbiAgICAgICAgICAgIDxFcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICAgICAgICAgPGRpdj5UZXN0IGNvbnRlbnQ8L2Rpdj5cclxuICAgICAgICAgICAgPC9FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdUZXN0IGNvbnRlbnQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdyZW5kZXJzIGVycm9yIGZhbGxiYWNrIHdoZW4gY2hpbGQgdGhyb3dzIGVycm9yJywgKCkgPT4ge1xyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPEVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgICAgICAgICA8VGhyb3dFcnJvciBzaG91bGRUaHJvdz17dHJ1ZX0gLz5cclxuICAgICAgICAgICAgPC9FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTb21ldGhpbmcgd2VudCB3cm9uZycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXZSBlbmNvdW50ZXJlZCBhbiB1bmV4cGVjdGVkIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluIG9yIHJlbG9hZCB0aGUgcGFnZS4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVHJ5IEFnYWluJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1JlbG9hZCBQYWdlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnY2FsbHMgb25FcnJvciBjYWxsYmFjayB3aGVuIGVycm9yIG9jY3VycycsICgpID0+IHtcclxuICAgICAgICBjb25zdCBvbkVycm9yID0gamVzdC5mbigpO1xyXG5cclxuICAgICAgICByZW5kZXIoXHJcbiAgICAgICAgICAgIDxFcnJvckJvdW5kYXJ5IG9uRXJyb3I9e29uRXJyb3J9PlxyXG4gICAgICAgICAgICAgICAgPFRocm93RXJyb3Igc2hvdWxkVGhyb3c9e3RydWV9IC8+XHJcbiAgICAgICAgICAgIDwvRXJyb3JCb3VuZGFyeT5cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBleHBlY3Qob25FcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgICAgIGV4cGVjdC5hbnkoRXJyb3IpLFxyXG4gICAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnRTdGFjazogZXhwZWN0LmFueShTdHJpbmcpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdyZXNldHMgZXJyb3Igc3RhdGUgd2hlbiBUcnkgQWdhaW4gaXMgY2xpY2tlZCcsICgpID0+IHtcclxuICAgICAgICBjb25zdCB7IHJlcmVuZGVyIH0gPSByZW5kZXIoXHJcbiAgICAgICAgICAgIDxFcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICAgICAgICAgPFRocm93RXJyb3Igc2hvdWxkVGhyb3c9e3RydWV9IC8+XHJcbiAgICAgICAgICAgIDwvRXJyb3JCb3VuZGFyeT5cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU29tZXRoaW5nIHdlbnQgd3JvbmcnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuXHJcbiAgICAgICAgLy8gQ2xpY2sgVHJ5IEFnYWluXHJcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJ1RyeSBBZ2FpbicpKTtcclxuXHJcbiAgICAgICAgLy8gUmUtcmVuZGVyIHdpdGggbm8gZXJyb3JcclxuICAgICAgICByZXJlbmRlcihcclxuICAgICAgICAgICAgPEVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgICAgICAgICA8VGhyb3dFcnJvciBzaG91bGRUaHJvdz17ZmFsc2V9IC8+XHJcbiAgICAgICAgICAgIDwvRXJyb3JCb3VuZGFyeT5cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBUaGUgZXJyb3IgYm91bmRhcnkgc2hvdWxkIHN0aWxsIHNob3cgdGhlIGVycm9yIHN0YXRlIHVudGlsIHRoZSBjb21wb25lbnQgcmUtcmVuZGVyc1xyXG4gICAgICAgIC8vIExldCdzIGNoZWNrIHRoYXQgdGhlIGVycm9yIGJvdW5kYXJ5IGlzIHdvcmtpbmcgY29ycmVjdGx5XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NvbWV0aGluZyB3ZW50IHdyb25nJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncmVsb2FkcyBwYWdlIHdoZW4gUmVsb2FkIFBhZ2UgaXMgY2xpY2tlZCcsICgpID0+IHtcclxuICAgICAgICBjb25zdCByZWxvYWRNb2NrID0gamVzdC5mbigpO1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdsb2NhdGlvbicsIHtcclxuICAgICAgICAgICAgdmFsdWU6IHsgcmVsb2FkOiByZWxvYWRNb2NrIH0sXHJcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPEVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgICAgICAgICA8VGhyb3dFcnJvciBzaG91bGRUaHJvdz17dHJ1ZX0gLz5cclxuICAgICAgICAgICAgPC9FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCdSZWxvYWQgUGFnZScpKTtcclxuICAgICAgICBleHBlY3QocmVsb2FkTW9jaykudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3JlbmRlcnMgY3VzdG9tIGZhbGxiYWNrIHdoZW4gcHJvdmlkZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY3VzdG9tRmFsbGJhY2sgPSA8ZGl2PkN1c3RvbSBlcnJvciBtZXNzYWdlPC9kaXY+O1xyXG5cclxuICAgICAgICByZW5kZXIoXHJcbiAgICAgICAgICAgIDxFcnJvckJvdW5kYXJ5IGZhbGxiYWNrPXtjdXN0b21GYWxsYmFja30+XHJcbiAgICAgICAgICAgICAgICA8VGhyb3dFcnJvciBzaG91bGRUaHJvdz17dHJ1ZX0gLz5cclxuICAgICAgICAgICAgPC9FcnJvckJvdW5kYXJ5PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdDdXN0b20gZXJyb3IgbWVzc2FnZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeVRleHQoJ1NvbWV0aGluZyB3ZW50IHdyb25nJykpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3dzIGVycm9yIGRldGFpbHMgaW4gZGV2ZWxvcG1lbnQgbW9kZScsICgpID0+IHtcclxuICAgICAgICBjb25zdCBvcmlnaW5hbEVudiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WO1xyXG4gICAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ2RldmVsb3BtZW50JztcclxuXHJcbiAgICAgICAgcmVuZGVyKFxyXG4gICAgICAgICAgICA8RXJyb3JCb3VuZGFyeT5cclxuICAgICAgICAgICAgICAgIDxUaHJvd0Vycm9yIHNob3VsZFRocm93PXt0cnVlfSAvPlxyXG4gICAgICAgICAgICA8L0Vycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0Vycm9yIERldGFpbHMgKERldmVsb3BtZW50KScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG5cclxuICAgICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9IG9yaWdpbmFsRW52O1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RvZXMgbm90IHNob3cgZXJyb3IgZGV0YWlscyBpbiBwcm9kdWN0aW9uIG1vZGUnLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgb3JpZ2luYWxFbnYgPSBwcm9jZXNzLmVudi5OT0RFX0VOVjtcclxuICAgICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICdwcm9kdWN0aW9uJztcclxuXHJcbiAgICAgICAgcmVuZGVyKFxyXG4gICAgICAgICAgICA8RXJyb3JCb3VuZGFyeT5cclxuICAgICAgICAgICAgICAgIDxUaHJvd0Vycm9yIHNob3VsZFRocm93PXt0cnVlfSAvPlxyXG4gICAgICAgICAgICA8L0Vycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGV4dCgnRXJyb3IgRGV0YWlscyAoRGV2ZWxvcG1lbnQpJykpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG5cclxuICAgICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9IG9yaWdpbmFsRW52O1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuZGVzY3JpYmUoJ1NjcmVlbkVycm9yQm91bmRhcnknLCAoKSA9PiB7XHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdyZW5kZXJzIGNoaWxkcmVuIHdoZW4gdGhlcmUgaXMgbm8gZXJyb3InLCAoKSA9PiB7XHJcbiAgICAgICAgcmVuZGVyKFxyXG4gICAgICAgICAgICA8U2NyZWVuRXJyb3JCb3VuZGFyeSBzY3JlZW5OYW1lPVwiVGVzdFNjcmVlblwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdj5TY3JlZW4gY29udGVudDwvZGl2PlxyXG4gICAgICAgICAgICA8L1NjcmVlbkVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NjcmVlbiBjb250ZW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncmVuZGVycyBzY3JlZW4tc3BlY2lmaWMgZXJyb3IgZmFsbGJhY2sgd2hlbiBjaGlsZCB0aHJvd3MgZXJyb3InLCAoKSA9PiB7XHJcbiAgICAgICAgcmVuZGVyKFxyXG4gICAgICAgICAgICA8U2NyZWVuRXJyb3JCb3VuZGFyeSBzY3JlZW5OYW1lPVwiVGVzdFNjcmVlblwiPlxyXG4gICAgICAgICAgICAgICAgPFRocm93RXJyb3Igc2hvdWxkVGhyb3c9e3RydWV9IC8+XHJcbiAgICAgICAgICAgIDwvU2NyZWVuRXJyb3JCb3VuZGFyeT5cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVGVzdFNjcmVlbiBFcnJvcicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXZSBlbmNvdW50ZXJlZCBhbiBpc3N1ZSB3aXRoIHRoZSBUZXN0U2NyZWVuIHNjcmVlbi4gWW91IGNhbiB0cnkgYWdhaW4gb3IgcmV0dXJuIHRvIHRoZSBob21lIHNjcmVlbi4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVHJ5IEFnYWluJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0dvIHRvIEhvbWUnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdjYWxscyBvbkVycm9yIGNhbGxiYWNrIHdoZW4gZXJyb3Igb2NjdXJzJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG9uRXJyb3IgPSBqZXN0LmZuKCk7XHJcblxyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPFNjcmVlbkVycm9yQm91bmRhcnkgc2NyZWVuTmFtZT1cIlRlc3RTY3JlZW5cIiBvbkVycm9yPXtvbkVycm9yfT5cclxuICAgICAgICAgICAgICAgIDxUaHJvd0Vycm9yIHNob3VsZFRocm93PXt0cnVlfSAvPlxyXG4gICAgICAgICAgICA8L1NjcmVlbkVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZXhwZWN0KG9uRXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgICAgICBleHBlY3QuYW55KEVycm9yKSxcclxuICAgICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50U3RhY2s6IGV4cGVjdC5hbnkoU3RyaW5nKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncmVzZXRzIGVycm9yIHN0YXRlIHdoZW4gVHJ5IEFnYWluIGlzIGNsaWNrZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyByZXJlbmRlciB9ID0gcmVuZGVyKFxyXG4gICAgICAgICAgICA8U2NyZWVuRXJyb3JCb3VuZGFyeSBzY3JlZW5OYW1lPVwiVGVzdFNjcmVlblwiPlxyXG4gICAgICAgICAgICAgICAgPFRocm93RXJyb3Igc2hvdWxkVGhyb3c9e3RydWV9IC8+XHJcbiAgICAgICAgICAgIDwvU2NyZWVuRXJyb3JCb3VuZGFyeT5cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVGVzdFNjcmVlbiBFcnJvcicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG5cclxuICAgICAgICAvLyBDbGljayBUcnkgQWdhaW5cclxuICAgICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnVHJ5IEFnYWluJykpO1xyXG5cclxuICAgICAgICAvLyBSZS1yZW5kZXIgd2l0aCBubyBlcnJvclxyXG4gICAgICAgIHJlcmVuZGVyKFxyXG4gICAgICAgICAgICA8U2NyZWVuRXJyb3JCb3VuZGFyeSBzY3JlZW5OYW1lPVwiVGVzdFNjcmVlblwiPlxyXG4gICAgICAgICAgICAgICAgPFRocm93RXJyb3Igc2hvdWxkVGhyb3c9e2ZhbHNlfSAvPlxyXG4gICAgICAgICAgICA8L1NjcmVlbkVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gVGhlIGVycm9yIGJvdW5kYXJ5IHNob3VsZCBzdGlsbCBzaG93IHRoZSBlcnJvciBzdGF0ZSB1bnRpbCB0aGUgY29tcG9uZW50IHJlLXJlbmRlcnNcclxuICAgICAgICAvLyBMZXQncyBjaGVjayB0aGF0IHRoZSBlcnJvciBib3VuZGFyeSBpcyB3b3JraW5nIGNvcnJlY3RseVxyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdUZXN0U2NyZWVuIEVycm9yJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnbmF2aWdhdGVzIHRvIGhvbWUgd2hlbiBHbyB0byBIb21lIGlzIGNsaWNrZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgbG9jYXRpb25Nb2NrID0gamVzdC5mbigpO1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdsb2NhdGlvbicsIHtcclxuICAgICAgICAgICAgdmFsdWU6IHsgaHJlZjogbG9jYXRpb25Nb2NrIH0sXHJcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJlbmRlcihcclxuICAgICAgICAgICAgPFNjcmVlbkVycm9yQm91bmRhcnkgc2NyZWVuTmFtZT1cIlRlc3RTY3JlZW5cIj5cclxuICAgICAgICAgICAgICAgIDxUaHJvd0Vycm9yIHNob3VsZFRocm93PXt0cnVlfSAvPlxyXG4gICAgICAgICAgICA8L1NjcmVlbkVycm9yQm91bmRhcnk+XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJ0dvIHRvIEhvbWUnKSk7XHJcbiAgICAgICAgZXhwZWN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKS50b0JlKCcvJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnbG9ncyBzY3JlZW4tc3BlY2lmaWMgZXJyb3IgaW5mb3JtYXRpb24nLCAoKSA9PiB7XHJcbiAgICAgICAgcmVuZGVyKFxyXG4gICAgICAgICAgICA8U2NyZWVuRXJyb3JCb3VuZGFyeSBzY3JlZW5OYW1lPVwiVGVzdFNjcmVlblwiPlxyXG4gICAgICAgICAgICAgICAgPFRocm93RXJyb3Igc2hvdWxkVGhyb3c9e3RydWV9IC8+XHJcbiAgICAgICAgICAgIDwvU2NyZWVuRXJyb3JCb3VuZGFyeT5cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBleHBlY3QoY29uc29sZS5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgICAgICdTY3JlZW4gRXJyb3IgQm91bmRhcnkgKFRlc3RTY3JlZW4pOicsXHJcbiAgICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcclxuICAgICAgICAgICAgICAgIGVycm9yOiBleHBlY3QuYW55KFN0cmluZyksXHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnRTdGFjazogZXhwZWN0LmFueShTdHJpbmcpLFxyXG4gICAgICAgICAgICAgICAgc2NyZWVuTmFtZTogJ1Rlc3RTY3JlZW4nLFxyXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBleHBlY3QuYW55KFN0cmluZyksXHJcbiAgICAgICAgICAgICAgICB1cmw6IGV4cGVjdC5hbnkoU3RyaW5nKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxufSk7XHJcbiJdLCJ2ZXJzaW9uIjozfQ==