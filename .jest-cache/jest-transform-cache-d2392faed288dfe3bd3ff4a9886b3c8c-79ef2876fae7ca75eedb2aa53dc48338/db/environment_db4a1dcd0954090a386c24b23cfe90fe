7443e0d3ca6888e4ce2100863eba266a
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.env = exports.config = void 0;
exports.loadEnvironment = loadEnvironment;
exports.validateProductionEnvironment = validateProductionEnvironment;
exports.getEnvironmentSummary = getEnvironmentSummary;
const zod_1 = require("zod");
const logger_1 = require("../core/logging/logger");
/**
 * Environment schema with validation and defaults
 */
const envSchema = zod_1.z.object({
    // API Configuration
    API_BASE_URL: zod_1.z.string().url().default('http://localhost:3001'),
    API_TIMEOUT: zod_1.z.number().min(1000).max(30000).default(5000),
    // AI Providers
    ANTHROPIC_API_KEY: zod_1.z.string().optional(),
    OPENAI_API_KEY: zod_1.z.string().optional(),
    AI_PROVIDER: zod_1.z.enum(['anthropic', 'openai', 'azure']).default('anthropic'),
    // Security
    CORS_ORIGIN: zod_1.z.string().default('http://localhost:5173'),
    RATE_LIMIT_REQUESTS: zod_1.z.number().min(1).max(1000).default(100),
    RATE_LIMIT_WINDOW: zod_1.z.number().min(1000).max(3600000).default(60000), // 1 minute
    // Features
    ENABLE_LOGGING: zod_1.z.boolean().default(true),
    ENABLE_MONITORING: zod_1.z.boolean().default(false),
    ENABLE_CACHE: zod_1.z.boolean().default(true),
    // Performance
    MAX_FILE_SIZE: zod_1.z.number().min(1024 * 1024).max(100 * 1024 * 1024).default(20 * 1024 * 1024), // 20MB
    MAX_CONCURRENT_REQUESTS: zod_1.z.number().min(1).max(50).default(5),
    CACHE_TTL: zod_1.z.number().min(60).max(86400).default(3600), // 1 hour
    // Development
    NODE_ENV: zod_1.z.enum(['development', 'production', 'test']).default('development'),
    DEBUG: zod_1.z.boolean().default(false),
    // Retry Configuration
    RETRY_MAX_ATTEMPTS: zod_1.z.number().min(1).max(10).default(3),
    RETRY_INITIAL_DELAY: zod_1.z.number().min(100).max(10000).default(1000),
    RETRY_MAX_DELAY: zod_1.z.number().min(1000).max(60000).default(10000),
    // Circuit Breaker Configuration
    CIRCUIT_BREAKER_FAILURE_THRESHOLD: zod_1.z.number().min(1).max(20).default(5),
    CIRCUIT_BREAKER_RESET_TIMEOUT: zod_1.z.number().min(1000).max(300000).default(60000), // 1 minute
    CIRCUIT_BREAKER_SUCCESS_THRESHOLD: zod_1.z.number().min(1).max(10).default(2),
});
/**
 * Load and validate environment configuration
 */
function loadEnvironment() {
    const env = {
        API_BASE_URL: import.meta.env.VITE_API_BASE_URL,
        API_TIMEOUT: Number(import.meta.env.VITE_API_TIMEOUT),
        ANTHROPIC_API_KEY: import.meta.env.VITE_ANTHROPIC_API_KEY,
        OPENAI_API_KEY: import.meta.env.VITE_OPENAI_API_KEY,
        AI_PROVIDER: import.meta.env.VITE_AI_PROVIDER,
        CORS_ORIGIN: import.meta.env.VITE_CORS_ORIGIN,
        RATE_LIMIT_REQUESTS: Number(import.meta.env.VITE_RATE_LIMIT_REQUESTS),
        RATE_LIMIT_WINDOW: Number(import.meta.env.VITE_RATE_LIMIT_WINDOW),
        ENABLE_LOGGING: import.meta.env.VITE_ENABLE_LOGGING === 'true',
        ENABLE_MONITORING: import.meta.env.VITE_ENABLE_MONITORING === 'true',
        ENABLE_CACHE: import.meta.env.VITE_ENABLE_CACHE === 'true',
        MAX_FILE_SIZE: Number(import.meta.env.VITE_MAX_FILE_SIZE),
        MAX_CONCURRENT_REQUESTS: Number(import.meta.env.VITE_MAX_CONCURRENT_REQUESTS),
        CACHE_TTL: Number(import.meta.env.VITE_CACHE_TTL),
        NODE_ENV: import.meta.env.MODE || 'development',
        DEBUG: import.meta.env.VITE_DEBUG === 'true',
        RETRY_MAX_ATTEMPTS: Number(import.meta.env.VITE_RETRY_MAX_ATTEMPTS),
        RETRY_INITIAL_DELAY: Number(import.meta.env.VITE_RETRY_INITIAL_DELAY),
        RETRY_MAX_DELAY: Number(import.meta.env.VITE_RETRY_MAX_DELAY),
        CIRCUIT_BREAKER_FAILURE_THRESHOLD: Number(import.meta.env.VITE_CIRCUIT_BREAKER_FAILURE_THRESHOLD),
        CIRCUIT_BREAKER_RESET_TIMEOUT: Number(import.meta.env.VITE_CIRCUIT_BREAKER_RESET_TIMEOUT),
        CIRCUIT_BREAKER_SUCCESS_THRESHOLD: Number(import.meta.env.VITE_CIRCUIT_BREAKER_SUCCESS_THRESHOLD),
    };
    try {
        const validatedEnv = envSchema.parse(env);
        logger_1.logger.info('Environment configuration loaded successfully', {
            nodeEnv: validatedEnv.NODE_ENV,
            apiBaseUrl: validatedEnv.API_BASE_URL,
            aiProvider: validatedEnv.AI_PROVIDER,
            enableLogging: validatedEnv.ENABLE_LOGGING,
            enableCache: validatedEnv.ENABLE_CACHE,
            debug: validatedEnv.DEBUG
        });
        return validatedEnv;
    }
    catch (error) {
        logger_1.logger.error('Environment validation failed', {
            error: error instanceof Error ? error.message : String(error),
            env: Object.keys(env).filter(key => env[key] !== undefined)
        });
        throw new Error(`Invalid environment configuration: ${error instanceof Error ? error.message : String(error)}`);
    }
}
/**
 * Get environment configuration with validation
 */
exports.config = loadEnvironment();
/**
 * Environment configuration helpers
 */
exports.env = {
    /**
     * Check if running in development mode
     */
    isDevelopment: () => exports.config.NODE_ENV === 'development',
    /**
     * Check if running in production mode
     */
    isProduction: () => exports.config.NODE_ENV === 'production',
    /**
     * Check if running in test mode
     */
    isTest: () => exports.config.NODE_ENV === 'test',
    /**
     * Check if debug mode is enabled
     */
    isDebug: () => exports.config.DEBUG,
    /**
     * Get API configuration
     */
    api: {
        baseUrl: () => exports.config.API_BASE_URL,
        timeout: () => exports.config.API_TIMEOUT,
    },
    /**
     * Get AI provider configuration
     */
    ai: {
        provider: () => exports.config.AI_PROVIDER,
        anthropicKey: () => exports.config.ANTHROPIC_API_KEY,
        openaiKey: () => exports.config.OPENAI_API_KEY,
    },
    /**
     * Get security configuration
     */
    security: {
        corsOrigin: () => exports.config.CORS_ORIGIN,
        rateLimitRequests: () => exports.config.RATE_LIMIT_REQUESTS,
        rateLimitWindow: () => exports.config.RATE_LIMIT_WINDOW,
    },
    /**
     * Get feature flags
     */
    features: {
        logging: () => exports.config.ENABLE_LOGGING,
        monitoring: () => exports.config.ENABLE_MONITORING,
        cache: () => exports.config.ENABLE_CACHE,
    },
    /**
     * Get performance configuration
     */
    performance: {
        maxFileSize: () => exports.config.MAX_FILE_SIZE,
        maxConcurrentRequests: () => exports.config.MAX_CONCURRENT_REQUESTS,
        cacheTTL: () => exports.config.CACHE_TTL,
    },
    /**
     * Get retry configuration
     */
    retry: {
        maxAttempts: () => exports.config.RETRY_MAX_ATTEMPTS,
        initialDelay: () => exports.config.RETRY_INITIAL_DELAY,
        maxDelay: () => exports.config.RETRY_MAX_DELAY,
    },
    /**
     * Get circuit breaker configuration
     */
    circuitBreaker: {
        failureThreshold: () => exports.config.CIRCUIT_BREAKER_FAILURE_THRESHOLD,
        resetTimeout: () => exports.config.CIRCUIT_BREAKER_RESET_TIMEOUT,
        successThreshold: () => exports.config.CIRCUIT_BREAKER_SUCCESS_THRESHOLD,
    },
};
/**
 * Validate required environment variables for production
 */
function validateProductionEnvironment() {
    if (exports.env.isProduction()) {
        const requiredVars = [
            'API_BASE_URL',
            'ANTHROPIC_API_KEY',
            'OPENAI_API_KEY',
            'CORS_ORIGIN'
        ];
        const missingVars = requiredVars.filter(varName => {
            const value = exports.config[varName];
            return value === undefined || value === '';
        });
        if (missingVars.length > 0) {
            throw new Error(`Missing required environment variables for production: ${missingVars.join(', ')}`);
        }
        logger_1.logger.info('Production environment validation passed');
    }
}
/**
 * Get environment summary for debugging
 */
function getEnvironmentSummary() {
    return {
        nodeEnv: exports.config.NODE_ENV,
        debug: exports.config.DEBUG,
        apiBaseUrl: exports.config.API_BASE_URL,
        aiProvider: exports.config.AI_PROVIDER,
        features: {
            logging: exports.config.ENABLE_LOGGING,
            monitoring: exports.config.ENABLE_MONITORING,
            cache: exports.config.ENABLE_CACHE,
        },
        performance: {
            maxFileSize: `${exports.config.MAX_FILE_SIZE / (1024 * 1024)}MB`,
            maxConcurrentRequests: exports.config.MAX_CONCURRENT_REQUESTS,
            cacheTTL: `${exports.config.CACHE_TTL}s`,
        },
        retry: {
            maxAttempts: exports.config.RETRY_MAX_ATTEMPTS,
            initialDelay: `${exports.config.RETRY_INITIAL_DELAY}ms`,
            maxDelay: `${exports.config.RETRY_MAX_DELAY}ms`,
        },
        circuitBreaker: {
            failureThreshold: exports.config.CIRCUIT_BREAKER_FAILURE_THRESHOLD,
            resetTimeout: `${exports.config.CIRCUIT_BREAKER_RESET_TIMEOUT}ms`,
            successThreshold: exports.config.CIRCUIT_BREAKER_SUCCESS_THRESHOLD,
        },
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxzYXJhaFxcUmVwb3NcXENDSCBBeGNlc3MgSW50ZWxsaWdlbmNlIFZpYmVkXFxzcmNcXGNvbmZpZ1xcZW52aXJvbm1lbnQudHMiLCJtYXBwaW5ncyI6Ijs7O0FBbURBLDBDQThDQztBQWlHRCxzRUFvQkM7QUFLRCxzREEyQkM7QUF0UEQsNkJBQXdCO0FBQ3hCLG1EQUFnRDtBQUVoRDs7R0FFRztBQUNILE1BQU0sU0FBUyxHQUFHLE9BQUMsQ0FBQyxNQUFNLENBQUM7SUFDekIsb0JBQW9CO0lBQ3BCLFlBQVksRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLHVCQUF1QixDQUFDO0lBQy9ELFdBQVcsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDO0lBRTFELGVBQWU7SUFDZixpQkFBaUIsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsUUFBUSxFQUFFO0lBQ3hDLGNBQWMsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsUUFBUSxFQUFFO0lBQ3JDLFdBQVcsRUFBRSxPQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsV0FBVyxFQUFFLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUM7SUFFMUUsV0FBVztJQUNYLFdBQVcsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsT0FBTyxDQUFDLHVCQUF1QixDQUFDO0lBQ3hELG1CQUFtQixFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUM7SUFDN0QsaUJBQWlCLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFH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O1lBQ0wsV0FBVyxFQUFFLGNBQU0sQ0FBQyxrQkFBa0I7WUFDdEMsWUFBWSxFQUFFLEdBQUcsY0FBTSxDQUFDLG1CQUFtQixJQUFJO1lBQy9DLFFBQVEsRUFBRSxHQUFHLGNBQU0sQ0FBQyxlQUFlLElBQUk7U0FDeEM7UUFDRCxjQUFjLEVBQUU7WUFDZCxnQkFBZ0IsRUFBRSxjQUFNLENBQUMsaUNBQWlDO1lBQzFELFlBQVksRUFBRSxHQUFHLGNBQU0sQ0FBQyw2QkFBNkIsSUFBSTtZQUN6RCxnQkFBZ0IsRUFBRSxjQUFNLENBQUMsaUNBQWlDO1NBQzNEO0tBQ0YsQ0FBQztBQUNKLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzYXJhaFxcUmVwb3NcXENDSCBBeGNlc3MgSW50ZWxsaWdlbmNlIFZpYmVkXFxzcmNcXGNvbmZpZ1xcZW52aXJvbm1lbnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XHJcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJy4uL2NvcmUvbG9nZ2luZy9sb2dnZXInO1xyXG5cclxuLyoqXHJcbiAqIEVudmlyb25tZW50IHNjaGVtYSB3aXRoIHZhbGlkYXRpb24gYW5kIGRlZmF1bHRzXHJcbiAqL1xyXG5jb25zdCBlbnZTY2hlbWEgPSB6Lm9iamVjdCh7XHJcbiAgLy8gQVBJIENvbmZpZ3VyYXRpb25cclxuICBBUElfQkFTRV9VUkw6IHouc3RyaW5nKCkudXJsKCkuZGVmYXVsdCgnaHR0cDovL2xvY2FsaG9zdDozMDAxJyksXHJcbiAgQVBJX1RJTUVPVVQ6IHoubnVtYmVyKCkubWluKDEwMDApLm1heCgzMDAwMCkuZGVmYXVsdCg1MDAwKSxcclxuICBcclxuICAvLyBBSSBQcm92aWRlcnNcclxuICBBTlRIUk9QSUNfQVBJX0tFWTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxyXG4gIE9QRU5BSV9BUElfS0VZOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXHJcbiAgQUlfUFJPVklERVI6IHouZW51bShbJ2FudGhyb3BpYycsICdvcGVuYWknLCAnYXp1cmUnXSkuZGVmYXVsdCgnYW50aHJvcGljJyksXHJcbiAgXHJcbiAgLy8gU2VjdXJpdHlcclxuICBDT1JTX09SSUdJTjogei5zdHJpbmcoKS5kZWZhdWx0KCdodHRwOi8vbG9jYWxob3N0OjUxNzMnKSxcclxuICBSQVRFX0xJTUlUX1JFUVVFU1RTOiB6Lm51bWJlcigpLm1pbigxKS5tYXgoMTAwMCkuZGVmYXVsdCgxMDApLFxyXG4gIFJBVEVfTElNSVRfV0lORE9XOiB6Lm51bWJlcigpLm1pbigxMDAwKS5tYXgoMzYwMDAwMCkuZGVmYXVsdCg2MDAwMCksIC8vIDEgbWludXRlXHJcbiAgXHJcbiAgLy8gRmVhdHVyZXNcclxuICBFTkFCTEVfTE9HR0lORzogei5ib29sZWFuKCkuZGVmYXVsdCh0cnVlKSxcclxuICBFTkFCTEVfTU9OSVRPUklORzogei5ib29sZWFuKCkuZGVmYXVsdChmYWxzZSksXHJcbiAgRU5BQkxFX0NBQ0hFOiB6LmJvb2xlYW4oKS5kZWZhdWx0KHRydWUpLFxyXG4gIFxyXG4gIC8vIFBlcmZvcm1hbmNlXHJcbiAgTUFYX0ZJTEVfU0laRTogei5udW1iZXIoKS5taW4oMTAyNCAqIDEwMjQpLm1heCgxMDAgKiAxMDI0ICogMTAyNCkuZGVmYXVsdCgyMCAqIDEwMjQgKiAxMDI0KSwgLy8gMjBNQlxyXG4gIE1BWF9DT05DVVJSRU5UX1JFUVVFU1RTOiB6Lm51bWJlcigpLm1pbigxKS5tYXgoNTApLmRlZmF1bHQoNSksXHJcbiAgQ0FDSEVfVFRMOiB6Lm51bWJlcigpLm1pbig2MCkubWF4KDg2NDAwKS5kZWZhdWx0KDM2MDApLCAvLyAxIGhvdXJcclxuICBcclxuICAvLyBEZXZlbG9wbWVudFxyXG4gIE5PREVfRU5WOiB6LmVudW0oWydkZXZlbG9wbWVudCcsICdwcm9kdWN0aW9uJywgJ3Rlc3QnXSkuZGVmYXVsdCgnZGV2ZWxvcG1lbnQnKSxcclxuICBERUJVRzogei5ib29sZWFuKCkuZGVmYXVsdChmYWxzZSksXHJcbiAgXHJcbiAgLy8gUmV0cnkgQ29uZmlndXJhdGlvblxyXG4gIFJFVFJZX01BWF9BVFRFTVBUUzogei5udW1iZXIoKS5taW4oMSkubWF4KDEwKS5kZWZhdWx0KDMpLFxyXG4gIFJFVFJZX0lOSVRJQUxfREVMQVk6IHoubnVtYmVyKCkubWluKDEwMCkubWF4KDEwMDAwKS5kZWZhdWx0KDEwMDApLFxyXG4gIFJFVFJZX01BWF9ERUxBWTogei5udW1iZXIoKS5taW4oMTAwMCkubWF4KDYwMDAwKS5kZWZhdWx0KDEwMDAwKSxcclxuICBcclxuICAvLyBDaXJjdWl0IEJyZWFrZXIgQ29uZmlndXJhdGlvblxyXG4gIENJUkNVSVRfQlJFQUtFUl9GQUlMVVJFX1RIUkVTSE9MRDogei5udW1iZXIoKS5taW4oMSkubWF4KDIwKS5kZWZhdWx0KDUpLFxyXG4gIENJUkNVSVRfQlJFQUtFUl9SRVNFVF9USU1FT1VUOiB6Lm51bWJlcigpLm1pbigxMDAwKS5tYXgoMzAwMDAwKS5kZWZhdWx0KDYwMDAwKSwgLy8gMSBtaW51dGVcclxuICBDSVJDVUlUX0JSRUFLRVJfU1VDQ0VTU19USFJFU0hPTEQ6IHoubnVtYmVyKCkubWluKDEpLm1heCgxMCkuZGVmYXVsdCgyKSxcclxufSk7XHJcblxyXG5leHBvcnQgdHlwZSBFbnZpcm9ubWVudCA9IHouaW5mZXI8dHlwZW9mIGVudlNjaGVtYT47XHJcblxyXG4vKipcclxuICogTG9hZCBhbmQgdmFsaWRhdGUgZW52aXJvbm1lbnQgY29uZmlndXJhdGlvblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGxvYWRFbnZpcm9ubWVudCgpOiBFbnZpcm9ubWVudCB7XHJcbiAgY29uc3QgZW52ID0ge1xyXG4gICAgQVBJX0JBU0VfVVJMOiBpbXBvcnQubWV0YS5lbnYuVklURV9BUElfQkFTRV9VUkwsXHJcbiAgICBBUElfVElNRU9VVDogTnVtYmVyKGltcG9ydC5tZXRhLmVudi5WSVRFX0FQSV9USU1FT1VUKSxcclxuICAgIEFOVEhST1BJQ19BUElfS0VZOiBpbXBvcnQubWV0YS5lbnYuVklURV9BTlRIUk9QSUNfQVBJX0tFWSxcclxuICAgIE9QRU5BSV9BUElfS0VZOiBpbXBvcnQubWV0YS5lbnYuVklURV9PUEVOQUlfQVBJX0tFWSxcclxuICAgIEFJX1BST1ZJREVSOiBpbXBvcnQubWV0YS5lbnYuVklURV9BSV9QUk9WSURFUixcclxuICAgIENPUlNfT1JJR0lOOiBpbXBvcnQubWV0YS5lbnYuVklURV9DT1JTX09SSUdJTixcclxuICAgIFJBVEVfTElNSVRfUkVRVUVTVFM6IE51bWJlcihpbXBvcnQubWV0YS5lbnYuVklURV9SQVRFX0xJTUlUX1JFUVVFU1RTKSxcclxuICAgIFJBVEVfTElNSVRfV0lORE9XOiBOdW1iZXIoaW1wb3J0Lm1ldGEuZW52LlZJVEVfUkFURV9MSU1JVF9XSU5ET1cpLFxyXG4gICAgRU5BQkxFX0xPR0dJTkc6IGltcG9ydC5tZXRhLmVudi5WSVRFX0VOQUJMRV9MT0dHSU5HID09PSAndHJ1ZScsXHJcbiAgICBFTkFCTEVfTU9OSVRPUklORzogaW1wb3J0Lm1ldGEuZW52LlZJVEVfRU5BQkxFX01PTklUT1JJTkcgPT09ICd0cnVlJyxcclxuICAgIEVOQUJMRV9DQUNIRTogaW1wb3J0Lm1ldGEuZW52LlZJVEVfRU5BQkxFX0NBQ0hFID09PSAndHJ1ZScsXHJcbiAgICBNQVhfRklMRV9TSVpFOiBOdW1iZXIoaW1wb3J0Lm1ldGEuZW52LlZJVEVfTUFYX0ZJTEVfU0laRSksXHJcbiAgICBNQVhfQ09OQ1VSUkVOVF9SRVFVRVNUUzogTnVtYmVyKGltcG9ydC5tZXRhLmVudi5WSVRFX01BWF9DT05DVVJSRU5UX1JFUVVFU1RTKSxcclxuICAgIENBQ0hFX1RUTDogTnVtYmVyKGltcG9ydC5tZXRhLmVudi5WSVRFX0NBQ0hFX1RUTCksXHJcbiAgICBOT0RFX0VOVjogaW1wb3J0Lm1ldGEuZW52Lk1PREUgfHwgJ2RldmVsb3BtZW50JyxcclxuICAgIERFQlVHOiBpbXBvcnQubWV0YS5lbnYuVklURV9ERUJVRyA9PT0gJ3RydWUnLFxyXG4gICAgUkVUUllfTUFYX0FUVEVNUFRTOiBOdW1iZXIoaW1wb3J0Lm1ldGEuZW52LlZJVEVfUkVUUllfTUFYX0FUVEVNUFRTKSxcclxuICAgIFJFVFJZX0lOSVRJQUxfREVMQVk6IE51bWJlcihpbXBvcnQubWV0YS5lbnYuVklURV9SRVRSWV9JTklUSUFMX0RFTEFZKSxcclxuICAgIFJFVFJZX01BWF9ERUxBWTogTnVtYmVyKGltcG9ydC5tZXRhLmVudi5WSVRFX1JFVFJZX01BWF9ERUxBWSksXHJcbiAgICBDSVJDVUlUX0JSRUFLRVJfRkFJTFVSRV9USFJFU0hPTEQ6IE51bWJlcihpbXBvcnQubWV0YS5lbnYuVklURV9DSVJDVUlUX0JSRUFLRVJfRkFJTFVSRV9USFJFU0hPTEQpLFxyXG4gICAgQ0lSQ1VJVF9CUkVBS0VSX1JFU0VUX1RJTUVPVVQ6IE51bWJlcihpbXBvcnQubWV0YS5lbnYuVklURV9DSVJDVUlUX0JSRUFLRVJfUkVTRVRfVElNRU9VVCksXHJcbiAgICBDSVJDVUlUX0JSRUFLRVJfU1VDQ0VTU19USFJFU0hPTEQ6IE51bWJlcihpbXBvcnQubWV0YS5lbnYuVklURV9DSVJDVUlUX0JSRUFLRVJfU1VDQ0VTU19USFJFU0hPTEQpLFxyXG4gIH07XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB2YWxpZGF0ZWRFbnYgPSBlbnZTY2hlbWEucGFyc2UoZW52KTtcclxuICAgIFxyXG4gICAgbG9nZ2VyLmluZm8oJ0Vudmlyb25tZW50IGNvbmZpZ3VyYXRpb24gbG9hZGVkIHN1Y2Nlc3NmdWxseScsIHtcclxuICAgICAgbm9kZUVudjogdmFsaWRhdGVkRW52Lk5PREVfRU5WLFxyXG4gICAgICBhcGlCYXNlVXJsOiB2YWxpZGF0ZWRFbnYuQVBJX0JBU0VfVVJMLFxyXG4gICAgICBhaVByb3ZpZGVyOiB2YWxpZGF0ZWRFbnYuQUlfUFJPVklERVIsXHJcbiAgICAgIGVuYWJsZUxvZ2dpbmc6IHZhbGlkYXRlZEVudi5FTkFCTEVfTE9HR0lORyxcclxuICAgICAgZW5hYmxlQ2FjaGU6IHZhbGlkYXRlZEVudi5FTkFCTEVfQ0FDSEUsXHJcbiAgICAgIGRlYnVnOiB2YWxpZGF0ZWRFbnYuREVCVUdcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICByZXR1cm4gdmFsaWRhdGVkRW52O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBsb2dnZXIuZXJyb3IoJ0Vudmlyb25tZW50IHZhbGlkYXRpb24gZmFpbGVkJywgeyBcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSxcclxuICAgICAgZW52OiBPYmplY3Qua2V5cyhlbnYpLmZpbHRlcihrZXkgPT4gZW52W2tleSBhcyBrZXlvZiB0eXBlb2YgZW52XSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgfSk7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgZW52aXJvbm1lbnQgY29uZmlndXJhdGlvbjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGVudmlyb25tZW50IGNvbmZpZ3VyYXRpb24gd2l0aCB2YWxpZGF0aW9uXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgY29uZmlnID0gbG9hZEVudmlyb25tZW50KCk7XHJcblxyXG4vKipcclxuICogRW52aXJvbm1lbnQgY29uZmlndXJhdGlvbiBoZWxwZXJzXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgZW52ID0ge1xyXG4gIC8qKlxyXG4gICAqIENoZWNrIGlmIHJ1bm5pbmcgaW4gZGV2ZWxvcG1lbnQgbW9kZVxyXG4gICAqL1xyXG4gIGlzRGV2ZWxvcG1lbnQ6ICgpID0+IGNvbmZpZy5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyxcclxuICBcclxuICAvKipcclxuICAgKiBDaGVjayBpZiBydW5uaW5nIGluIHByb2R1Y3Rpb24gbW9kZVxyXG4gICAqL1xyXG4gIGlzUHJvZHVjdGlvbjogKCkgPT4gY29uZmlnLk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXHJcbiAgXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgcnVubmluZyBpbiB0ZXN0IG1vZGVcclxuICAgKi9cclxuICBpc1Rlc3Q6ICgpID0+IGNvbmZpZy5OT0RFX0VOViA9PT0gJ3Rlc3QnLFxyXG4gIFxyXG4gIC8qKlxyXG4gICAqIENoZWNrIGlmIGRlYnVnIG1vZGUgaXMgZW5hYmxlZFxyXG4gICAqL1xyXG4gIGlzRGVidWc6ICgpID0+IGNvbmZpZy5ERUJVRyxcclxuICBcclxuICAvKipcclxuICAgKiBHZXQgQVBJIGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuICBhcGk6IHtcclxuICAgIGJhc2VVcmw6ICgpID0+IGNvbmZpZy5BUElfQkFTRV9VUkwsXHJcbiAgICB0aW1lb3V0OiAoKSA9PiBjb25maWcuQVBJX1RJTUVPVVQsXHJcbiAgfSxcclxuICBcclxuICAvKipcclxuICAgKiBHZXQgQUkgcHJvdmlkZXIgY29uZmlndXJhdGlvblxyXG4gICAqL1xyXG4gIGFpOiB7XHJcbiAgICBwcm92aWRlcjogKCkgPT4gY29uZmlnLkFJX1BST1ZJREVSLFxyXG4gICAgYW50aHJvcGljS2V5OiAoKSA9PiBjb25maWcuQU5USFJPUElDX0FQSV9LRVksXHJcbiAgICBvcGVuYWlLZXk6ICgpID0+IGNvbmZpZy5PUEVOQUlfQVBJX0tFWSxcclxuICB9LFxyXG4gIFxyXG4gIC8qKlxyXG4gICAqIEdldCBzZWN1cml0eSBjb25maWd1cmF0aW9uXHJcbiAgICovXHJcbiAgc2VjdXJpdHk6IHtcclxuICAgIGNvcnNPcmlnaW46ICgpID0+IGNvbmZpZy5DT1JTX09SSUdJTixcclxuICAgIHJhdGVMaW1pdFJlcXVlc3RzOiAoKSA9PiBjb25maWcuUkFURV9MSU1JVF9SRVFVRVNUUyxcclxuICAgIHJhdGVMaW1pdFdpbmRvdzogKCkgPT4gY29uZmlnLlJBVEVfTElNSVRfV0lORE9XLFxyXG4gIH0sXHJcbiAgXHJcbiAgLyoqXHJcbiAgICogR2V0IGZlYXR1cmUgZmxhZ3NcclxuICAgKi9cclxuICBmZWF0dXJlczoge1xyXG4gICAgbG9nZ2luZzogKCkgPT4gY29uZmlnLkVOQUJMRV9MT0dHSU5HLFxyXG4gICAgbW9uaXRvcmluZzogKCkgPT4gY29uZmlnLkVOQUJMRV9NT05JVE9SSU5HLFxyXG4gICAgY2FjaGU6ICgpID0+IGNvbmZpZy5FTkFCTEVfQ0FDSEUsXHJcbiAgfSxcclxuICBcclxuICAvKipcclxuICAgKiBHZXQgcGVyZm9ybWFuY2UgY29uZmlndXJhdGlvblxyXG4gICAqL1xyXG4gIHBlcmZvcm1hbmNlOiB7XHJcbiAgICBtYXhGaWxlU2l6ZTogKCkgPT4gY29uZmlnLk1BWF9GSUxFX1NJWkUsXHJcbiAgICBtYXhDb25jdXJyZW50UmVxdWVzdHM6ICgpID0+IGNvbmZpZy5NQVhfQ09OQ1VSUkVOVF9SRVFVRVNUUyxcclxuICAgIGNhY2hlVFRMOiAoKSA9PiBjb25maWcuQ0FDSEVfVFRMLFxyXG4gIH0sXHJcbiAgXHJcbiAgLyoqXHJcbiAgICogR2V0IHJldHJ5IGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuICByZXRyeToge1xyXG4gICAgbWF4QXR0ZW1wdHM6ICgpID0+IGNvbmZpZy5SRVRSWV9NQVhfQVRURU1QVFMsXHJcbiAgICBpbml0aWFsRGVsYXk6ICgpID0+IGNvbmZpZy5SRVRSWV9JTklUSUFMX0RFTEFZLFxyXG4gICAgbWF4RGVsYXk6ICgpID0+IGNvbmZpZy5SRVRSWV9NQVhfREVMQVksXHJcbiAgfSxcclxuICBcclxuICAvKipcclxuICAgKiBHZXQgY2lyY3VpdCBicmVha2VyIGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuICBjaXJjdWl0QnJlYWtlcjoge1xyXG4gICAgZmFpbHVyZVRocmVzaG9sZDogKCkgPT4gY29uZmlnLkNJUkNVSVRfQlJFQUtFUl9GQUlMVVJFX1RIUkVTSE9MRCxcclxuICAgIHJlc2V0VGltZW91dDogKCkgPT4gY29uZmlnLkNJUkNVSVRfQlJFQUtFUl9SRVNFVF9USU1FT1VULFxyXG4gICAgc3VjY2Vzc1RocmVzaG9sZDogKCkgPT4gY29uZmlnLkNJUkNVSVRfQlJFQUtFUl9TVUNDRVNTX1RIUkVTSE9MRCxcclxuICB9LFxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlcyBmb3IgcHJvZHVjdGlvblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlUHJvZHVjdGlvbkVudmlyb25tZW50KCk6IHZvaWQge1xyXG4gIGlmIChlbnYuaXNQcm9kdWN0aW9uKCkpIHtcclxuICAgIGNvbnN0IHJlcXVpcmVkVmFycyA9IFtcclxuICAgICAgJ0FQSV9CQVNFX1VSTCcsXHJcbiAgICAgICdBTlRIUk9QSUNfQVBJX0tFWScsXHJcbiAgICAgICdPUEVOQUlfQVBJX0tFWScsXHJcbiAgICAgICdDT1JTX09SSUdJTidcclxuICAgIF07XHJcbiAgICBcclxuICAgIGNvbnN0IG1pc3NpbmdWYXJzID0gcmVxdWlyZWRWYXJzLmZpbHRlcih2YXJOYW1lID0+IHtcclxuICAgICAgY29uc3QgdmFsdWUgPSBjb25maWdbdmFyTmFtZSBhcyBrZXlvZiBFbnZpcm9ubWVudF07XHJcbiAgICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAnJztcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpZiAobWlzc2luZ1ZhcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgcmVxdWlyZWQgZW52aXJvbm1lbnQgdmFyaWFibGVzIGZvciBwcm9kdWN0aW9uOiAke21pc3NpbmdWYXJzLmpvaW4oJywgJyl9YCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGxvZ2dlci5pbmZvKCdQcm9kdWN0aW9uIGVudmlyb25tZW50IHZhbGlkYXRpb24gcGFzc2VkJyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGVudmlyb25tZW50IHN1bW1hcnkgZm9yIGRlYnVnZ2luZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEVudmlyb25tZW50U3VtbWFyeSgpOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB7XHJcbiAgcmV0dXJuIHtcclxuICAgIG5vZGVFbnY6IGNvbmZpZy5OT0RFX0VOVixcclxuICAgIGRlYnVnOiBjb25maWcuREVCVUcsXHJcbiAgICBhcGlCYXNlVXJsOiBjb25maWcuQVBJX0JBU0VfVVJMLFxyXG4gICAgYWlQcm92aWRlcjogY29uZmlnLkFJX1BST1ZJREVSLFxyXG4gICAgZmVhdHVyZXM6IHtcclxuICAgICAgbG9nZ2luZzogY29uZmlnLkVOQUJMRV9MT0dHSU5HLFxyXG4gICAgICBtb25pdG9yaW5nOiBjb25maWcuRU5BQkxFX01PTklUT1JJTkcsXHJcbiAgICAgIGNhY2hlOiBjb25maWcuRU5BQkxFX0NBQ0hFLFxyXG4gICAgfSxcclxuICAgIHBlcmZvcm1hbmNlOiB7XHJcbiAgICAgIG1heEZpbGVTaXplOiBgJHtjb25maWcuTUFYX0ZJTEVfU0laRSAvICgxMDI0ICogMTAyNCl9TUJgLFxyXG4gICAgICBtYXhDb25jdXJyZW50UmVxdWVzdHM6IGNvbmZpZy5NQVhfQ09OQ1VSUkVOVF9SRVFVRVNUUyxcclxuICAgICAgY2FjaGVUVEw6IGAke2NvbmZpZy5DQUNIRV9UVEx9c2AsXHJcbiAgICB9LFxyXG4gICAgcmV0cnk6IHtcclxuICAgICAgbWF4QXR0ZW1wdHM6IGNvbmZpZy5SRVRSWV9NQVhfQVRURU1QVFMsXHJcbiAgICAgIGluaXRpYWxEZWxheTogYCR7Y29uZmlnLlJFVFJZX0lOSVRJQUxfREVMQVl9bXNgLFxyXG4gICAgICBtYXhEZWxheTogYCR7Y29uZmlnLlJFVFJZX01BWF9ERUxBWX1tc2AsXHJcbiAgICB9LFxyXG4gICAgY2lyY3VpdEJyZWFrZXI6IHtcclxuICAgICAgZmFpbHVyZVRocmVzaG9sZDogY29uZmlnLkNJUkNVSVRfQlJFQUtFUl9GQUlMVVJFX1RIUkVTSE9MRCxcclxuICAgICAgcmVzZXRUaW1lb3V0OiBgJHtjb25maWcuQ0lSQ1VJVF9CUkVBS0VSX1JFU0VUX1RJTUVPVVR9bXNgLFxyXG4gICAgICBzdWNjZXNzVGhyZXNob2xkOiBjb25maWcuQ0lSQ1VJVF9CUkVBS0VSX1NVQ0NFU1NfVEhSRVNIT0xELFxyXG4gICAgfSxcclxuICB9O1xyXG59XHJcbiJdLCJ2ZXJzaW9uIjozfQ==