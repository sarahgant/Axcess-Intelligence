0c4cde64ee2d610cc772103a029731d4
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const schemas_1 = require("../../src/core/validation/schemas");
(0, globals_1.describe)('Validation Schemas', () => {
    (0, globals_1.describe)('messageSchema', () => {
        (0, globals_1.it)('should validate a valid message', () => {
            const validMessage = {
                content: 'Hello, world!',
                role: 'user',
                timestamp: new Date(),
                metadata: { sessionId: '123' }
            };
            const result = schemas_1.messageSchema.safeParse(validMessage);
            (0, globals_1.expect)(result.success).toBe(true);
        });
        (0, globals_1.it)('should validate a minimal message', () => {
            const minimalMessage = {
                content: 'Test',
                role: 'assistant'
            };
            const result = schemas_1.messageSchema.safeParse(minimalMessage);
            (0, globals_1.expect)(result.success).toBe(true);
        });
        (0, globals_1.it)('should reject empty content', () => {
            const invalidMessage = {
                content: '',
                role: 'user'
            };
            const result = schemas_1.messageSchema.safeParse(invalidMessage);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('content');
            }
        });
        (0, globals_1.it)('should reject content that is too long', () => {
            const invalidMessage = {
                content: 'a'.repeat(10001),
                role: 'user'
            };
            const result = schemas_1.messageSchema.safeParse(invalidMessage);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('content');
            }
        });
        (0, globals_1.it)('should reject invalid role', () => {
            const invalidMessage = {
                content: 'Test',
                role: 'invalid'
            };
            const result = schemas_1.messageSchema.safeParse(invalidMessage);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('role');
            }
        });
    });
    (0, globals_1.describe)('fileUploadSchema', () => {
        (0, globals_1.it)('should validate a valid file upload', () => {
            const mockFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            const validUpload = {
                name: 'test.pdf',
                size: 1024,
                type: 'application/pdf',
                content: mockFile
            };
            const result = schemas_1.fileUploadSchema.safeParse(validUpload);
            (0, globals_1.expect)(result.success).toBe(true);
        });
        (0, globals_1.it)('should reject file with empty name', () => {
            const mockFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            const invalidUpload = {
                name: '',
                size: 1024,
                type: 'application/pdf',
                content: mockFile
            };
            const result = schemas_1.fileUploadSchema.safeParse(invalidUpload);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('name');
            }
        });
        (0, globals_1.it)('should reject file with name too long', () => {
            const mockFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            const invalidUpload = {
                name: 'a'.repeat(256),
                size: 1024,
                type: 'application/pdf',
                content: mockFile
            };
            const result = schemas_1.fileUploadSchema.safeParse(invalidUpload);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('name');
            }
        });
        (0, globals_1.it)('should reject file that is too large', () => {
            const mockFile = new File(['test content'], 'test.pdf', { type: 'application/pdf' });
            const invalidUpload = {
                name: 'test.pdf',
                size: 21 * 1024 * 1024, // 21MB
                type: 'application/pdf',
                content: mockFile
            };
            const result = schemas_1.fileUploadSchema.safeParse(invalidUpload);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('size');
            }
        });
        (0, globals_1.it)('should reject unsupported file type', () => {
            const mockFile = new File(['test content'], 'test.exe', { type: 'application/x-executable' });
            const invalidUpload = {
                name: 'test.exe',
                size: 1024,
                type: 'application/x-executable',
                content: mockFile
            };
            const result = schemas_1.fileUploadSchema.safeParse(invalidUpload);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('type');
            }
        });
        (0, globals_1.it)('should accept all supported file types', () => {
            const supportedTypes = [
                'application/pdf',
                'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                'text/plain',
                'image/png',
                'image/jpeg'
            ];
            supportedTypes.forEach(type => {
                const mockFile = new File(['test content'], 'test.file', { type });
                const validUpload = {
                    name: 'test.file',
                    size: 1024,
                    type: type,
                    content: mockFile
                };
                const result = schemas_1.fileUploadSchema.safeParse(validUpload);
                (0, globals_1.expect)(result.success).toBe(true);
            });
        });
    });
    (0, globals_1.describe)('apiRequestSchema', () => {
        (0, globals_1.it)('should validate a valid API request', () => {
            const validRequest = {
                messages: [
                    {
                        content: 'Hello',
                        role: 'user'
                    },
                    {
                        content: 'Hi there!',
                        role: 'assistant'
                    }
                ],
                model: 'gpt-4',
                temperature: 0.7,
                maxTokens: 1000
            };
            const result = schemas_1.apiRequestSchema.safeParse(validRequest);
            (0, globals_1.expect)(result.success).toBe(true);
        });
        (0, globals_1.it)('should validate minimal API request', () => {
            const minimalRequest = {
                messages: [
                    {
                        content: 'Hello',
                        role: 'user'
                    }
                ]
            };
            const result = schemas_1.apiRequestSchema.safeParse(minimalRequest);
            (0, globals_1.expect)(result.success).toBe(true);
        });
        (0, globals_1.it)('should reject empty messages array', () => {
            const invalidRequest = {
                messages: []
            };
            const result = schemas_1.apiRequestSchema.safeParse(invalidRequest);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('messages');
            }
        });
        (0, globals_1.it)('should reject invalid temperature', () => {
            const invalidRequest = {
                messages: [
                    {
                        content: 'Hello',
                        role: 'user'
                    }
                ],
                temperature: 3.0 // Too high
            };
            const result = schemas_1.apiRequestSchema.safeParse(invalidRequest);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('temperature');
            }
        });
        (0, globals_1.it)('should reject negative temperature', () => {
            const invalidRequest = {
                messages: [
                    {
                        content: 'Hello',
                        role: 'user'
                    }
                ],
                temperature: -0.1
            };
            const result = schemas_1.apiRequestSchema.safeParse(invalidRequest);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('temperature');
            }
        });
        (0, globals_1.it)('should reject invalid maxTokens', () => {
            const invalidRequest = {
                messages: [
                    {
                        content: 'Hello',
                        role: 'user'
                    }
                ],
                maxTokens: 0 // Too low
            };
            const result = schemas_1.apiRequestSchema.safeParse(invalidRequest);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('maxTokens');
            }
        });
        (0, globals_1.it)('should reject maxTokens that is too high', () => {
            const invalidRequest = {
                messages: [
                    {
                        content: 'Hello',
                        role: 'user'
                    }
                ],
                maxTokens: 100001 // Too high
            };
            const result = schemas_1.apiRequestSchema.safeParse(invalidRequest);
            (0, globals_1.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, globals_1.expect)(result.error.issues[0].path).toContain('maxTokens');
            }
        });
    });
    (0, globals_1.describe)('sanitizeInput', () => {
        (0, globals_1.it)('should remove HTML tags', () => {
            const input = '<script>alert("xss")</script>Hello world';
            const result = (0, schemas_1.sanitizeInput)(input);
            (0, globals_1.expect)(result).toBe('scriptalert("xss")/scriptHello world');
        });
        (0, globals_1.it)('should remove javascript protocol', () => {
            const input = 'javascript:alert("xss")';
            const result = (0, schemas_1.sanitizeInput)(input);
            (0, globals_1.expect)(result).toBe('alert("xss")');
        });
        (0, globals_1.it)('should remove event handlers', () => {
            const input = 'onclick=alert("xss") onload=alert("xss")';
            const result = (0, schemas_1.sanitizeInput)(input);
            (0, globals_1.expect)(result).toBe('alert("xss") alert("xss")');
        });
        (0, globals_1.it)('should trim whitespace', () => {
            const input = '  Hello world  ';
            const result = (0, schemas_1.sanitizeInput)(input);
            (0, globals_1.expect)(result).toBe('Hello world');
        });
        (0, globals_1.it)('should handle empty string', () => {
            const input = '';
            const result = (0, schemas_1.sanitizeInput)(input);
            (0, globals_1.expect)(result).toBe('');
        });
        (0, globals_1.it)('should handle string with only whitespace', () => {
            const input = '   \n\t  ';
            const result = (0, schemas_1.sanitizeInput)(input);
            (0, globals_1.expect)(result).toBe('');
        });
        (0, globals_1.it)('should preserve normal text', () => {
            const input = 'This is normal text with numbers 123 and symbols @#$%';
            const result = (0, schemas_1.sanitizeInput)(input);
            (0, globals_1.expect)(result).toBe('This is normal text with numbers 123 and symbols @#$%');
        });
        (0, globals_1.it)('should handle complex XSS attempts', () => {
            const input = '<img src="x" onerror="alert(\'xss\')">javascript:alert("xss")<script>alert("xss")</script>';
            const result = (0, schemas_1.sanitizeInput)(input);
            (0, globals_1.expect)(result).toBe('img src="x" "alert(\'xss\')"alert("xss")scriptalert("xss")/script');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxzYXJhaFxcUmVwb3NcXENDSCBBeGNlc3MgSW50ZWxsaWdlbmNlIFZpYmVkXFx0ZXN0c1xcdW5pdFxcdmFsaWRhdGlvbi1zY2hlbWFzLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSwyQ0FBcUQ7QUFDckQsK0RBSzJDO0FBRTNDLElBQUEsa0JBQVEsRUFBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7SUFDbEMsSUFBQSxrQkFBUSxFQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7UUFDN0IsSUFBQSxZQUFFLEVBQUMsaUNBQWlDLEVBQUUsR0FBRyxFQUFFO1lBQ3pDLE1BQU0sWUFBWSxHQUFHO2dCQUNuQixPQUFPLEVBQUUsZUFBZTtnQkFDeEIsSUFBSSxFQUFFLE1BQWU7Z0JBQ3JCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtnQkFDckIsUUFBUSxFQUFFLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRTthQUMvQixDQUFDO1lBRUYsTUFBTSxNQUFNLEdBQUcsdUJBQWEsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDckQsSUFBQSxnQkFBTSxFQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFBLFlBQUUsRUFBQyxtQ0FBbUMsRUFBRSxHQUFHLEVBQUU7WUFDM0MsTUFBTSxjQUFjLEdBQUc7Z0JBQ3JCLE9BQU8sRUFBRSxNQUFNO2dCQUNmLElBQUksRUFBRSxXQUFvQjthQUMzQixDQUFDO1lBRUYsTUFBTSxNQUFNLEdBQUcsdUJBQWEsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDdkQsSUFBQSxnQkFBTSxFQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFBLFlBQUUsRUFBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7WUFDckMsTUFBTSxjQUFjLEdB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QUMxQixNQUFNLE1BQU0sR0FBRyxJQUFBLHVCQUFhLEVBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEMsSUFBQSxnQkFBTSxFQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMxQixDQUFDLENBQUMsQ0FBQztRQUVILElBQUEsWUFBRSxFQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRTtZQUNyQyxNQUFNLEtBQUssR0FBRyx1REFBdUQsQ0FBQztZQUN0RSxNQUFNLE1BQU0sR0FBRyxJQUFBLHVCQUFhLEVBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEMsSUFBQSxnQkFBTSxFQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyx1REFBdUQsQ0FBQyxDQUFDO1FBQy9FLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBQSxZQUFFLEVBQUMsb0NBQW9DLEVBQUUsR0FBRyxFQUFFO1lBQzVDLE1BQU0sS0FBSyxHQUFHLDRGQUE0RixDQUFDO1lBQzNHLE1BQU0sTUFBTSxHQUFHLElBQUEsdUJBQWEsRUFBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxJQUFBLGdCQUFNLEVBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLG1FQUFtRSxDQUFDLENBQUM7UUFDM0YsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2FyYWhcXFJlcG9zXFxDQ0ggQXhjZXNzIEludGVsbGlnZW5jZSBWaWJlZFxcdGVzdHNcXHVuaXRcXHZhbGlkYXRpb24tc2NoZW1hcy50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XHJcbmltcG9ydCB7IFxyXG4gIG1lc3NhZ2VTY2hlbWEsIFxyXG4gIGZpbGVVcGxvYWRTY2hlbWEsIFxyXG4gIGFwaVJlcXVlc3RTY2hlbWEsIFxyXG4gIHNhbml0aXplSW5wdXQgXHJcbn0gZnJvbSAnLi4vLi4vc3JjL2NvcmUvdmFsaWRhdGlvbi9zY2hlbWFzJztcclxuXHJcbmRlc2NyaWJlKCdWYWxpZGF0aW9uIFNjaGVtYXMnLCAoKSA9PiB7XHJcbiAgZGVzY3JpYmUoJ21lc3NhZ2VTY2hlbWEnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGEgdmFsaWQgbWVzc2FnZScsICgpID0+IHtcclxuICAgICAgY29uc3QgdmFsaWRNZXNzYWdlID0ge1xyXG4gICAgICAgIGNvbnRlbnQ6ICdIZWxsbywgd29ybGQhJyxcclxuICAgICAgICByb2xlOiAndXNlcicgYXMgY29uc3QsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7IHNlc3Npb25JZDogJzEyMycgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gbWVzc2FnZVNjaGVtYS5zYWZlUGFyc2UodmFsaWRNZXNzYWdlKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhIG1pbmltYWwgbWVzc2FnZScsICgpID0+IHtcclxuICAgICAgY29uc3QgbWluaW1hbE1lc3NhZ2UgPSB7XHJcbiAgICAgICAgY29udGVudDogJ1Rlc3QnLFxyXG4gICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnIGFzIGNvbnN0XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBtZXNzYWdlU2NoZW1hLnNhZmVQYXJzZShtaW5pbWFsTWVzc2FnZSk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmVqZWN0IGVtcHR5IGNvbnRlbnQnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGludmFsaWRNZXNzYWdlID0ge1xyXG4gICAgICAgIGNvbnRlbnQ6ICcnLFxyXG4gICAgICAgIHJvbGU6ICd1c2VyJyBhcyBjb25zdFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gbWVzc2FnZVNjaGVtYS5zYWZlUGFyc2UoaW52YWxpZE1lc3NhZ2UpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5pc3N1ZXNbMF0ucGF0aCkudG9Db250YWluKCdjb250ZW50Jyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmVqZWN0IGNvbnRlbnQgdGhhdCBpcyB0b28gbG9uZycsICgpID0+IHtcclxuICAgICAgY29uc3QgaW52YWxpZE1lc3NhZ2UgPSB7XHJcbiAgICAgICAgY29udGVudDogJ2EnLnJlcGVhdCgxMDAwMSksXHJcbiAgICAgICAgcm9sZTogJ3VzZXInIGFzIGNvbnN0XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBtZXNzYWdlU2NoZW1hLnNhZmVQYXJzZShpbnZhbGlkTWVzc2FnZSk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XHJcbiAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9yLmlzc3Vlc1swXS5wYXRoKS50b0NvbnRhaW4oJ2NvbnRlbnQnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgaW52YWxpZCByb2xlJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBpbnZhbGlkTWVzc2FnZSA9IHtcclxuICAgICAgICBjb250ZW50OiAnVGVzdCcsXHJcbiAgICAgICAgcm9sZTogJ2ludmFsaWQnIGFzIGFueVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gbWVzc2FnZVNjaGVtYS5zYWZlUGFyc2UoaW52YWxpZE1lc3NhZ2UpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5pc3N1ZXNbMF0ucGF0aCkudG9Db250YWluKCdyb2xlJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnZmlsZVVwbG9hZFNjaGVtYScsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgYSB2YWxpZCBmaWxlIHVwbG9hZCcsICgpID0+IHtcclxuICAgICAgY29uc3QgbW9ja0ZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xyXG4gICAgICBjb25zdCB2YWxpZFVwbG9hZCA9IHtcclxuICAgICAgICBuYW1lOiAndGVzdC5wZGYnLFxyXG4gICAgICAgIHNpemU6IDEwMjQsXHJcbiAgICAgICAgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicgYXMgY29uc3QsXHJcbiAgICAgICAgY29udGVudDogbW9ja0ZpbGVcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGVVcGxvYWRTY2hlbWEuc2FmZVBhcnNlKHZhbGlkVXBsb2FkKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgZmlsZSB3aXRoIGVtcHR5IG5hbWUnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gbmV3IEZpbGUoWyd0ZXN0IGNvbnRlbnQnXSwgJ3Rlc3QucGRmJywgeyB0eXBlOiAnYXBwbGljYXRpb24vcGRmJyB9KTtcclxuICAgICAgY29uc3QgaW52YWxpZFVwbG9hZCA9IHtcclxuICAgICAgICBuYW1lOiAnJyxcclxuICAgICAgICBzaXplOiAxMDI0LFxyXG4gICAgICAgIHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIGFzIGNvbnN0LFxyXG4gICAgICAgIGNvbnRlbnQ6IG1vY2tGaWxlXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBmaWxlVXBsb2FkU2NoZW1hLnNhZmVQYXJzZShpbnZhbGlkVXBsb2FkKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcclxuICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuaXNzdWVzWzBdLnBhdGgpLnRvQ29udGFpbignbmFtZScpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJlamVjdCBmaWxlIHdpdGggbmFtZSB0b28gbG9uZycsICgpID0+IHtcclxuICAgICAgY29uc3QgbW9ja0ZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5wZGYnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xyXG4gICAgICBjb25zdCBpbnZhbGlkVXBsb2FkID0ge1xyXG4gICAgICAgIG5hbWU6ICdhJy5yZXBlYXQoMjU2KSxcclxuICAgICAgICBzaXplOiAxMDI0LFxyXG4gICAgICAgIHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIGFzIGNvbnN0LFxyXG4gICAgICAgIGNvbnRlbnQ6IG1vY2tGaWxlXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBmaWxlVXBsb2FkU2NoZW1hLnNhZmVQYXJzZShpbnZhbGlkVXBsb2FkKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcclxuICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuaXNzdWVzWzBdLnBhdGgpLnRvQ29udGFpbignbmFtZScpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJlamVjdCBmaWxlIHRoYXQgaXMgdG9vIGxhcmdlJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrRmlsZSA9IG5ldyBGaWxlKFsndGVzdCBjb250ZW50J10sICd0ZXN0LnBkZicsIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicgfSk7XHJcbiAgICAgIGNvbnN0IGludmFsaWRVcGxvYWQgPSB7XHJcbiAgICAgICAgbmFtZTogJ3Rlc3QucGRmJyxcclxuICAgICAgICBzaXplOiAyMSAqIDEwMjQgKiAxMDI0LCAvLyAyMU1CXHJcbiAgICAgICAgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicgYXMgY29uc3QsXHJcbiAgICAgICAgY29udGVudDogbW9ja0ZpbGVcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGVVcGxvYWRTY2hlbWEuc2FmZVBhcnNlKGludmFsaWRVcGxvYWQpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5pc3N1ZXNbMF0ucGF0aCkudG9Db250YWluKCdzaXplJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmVqZWN0IHVuc3VwcG9ydGVkIGZpbGUgdHlwZScsICgpID0+IHtcclxuICAgICAgY29uc3QgbW9ja0ZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5leGUnLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi94LWV4ZWN1dGFibGUnIH0pO1xyXG4gICAgICBjb25zdCBpbnZhbGlkVXBsb2FkID0ge1xyXG4gICAgICAgIG5hbWU6ICd0ZXN0LmV4ZScsXHJcbiAgICAgICAgc2l6ZTogMTAyNCxcclxuICAgICAgICB0eXBlOiAnYXBwbGljYXRpb24veC1leGVjdXRhYmxlJyBhcyBhbnksXHJcbiAgICAgICAgY29udGVudDogbW9ja0ZpbGVcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGVVcGxvYWRTY2hlbWEuc2FmZVBhcnNlKGludmFsaWRVcGxvYWQpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5pc3N1ZXNbMF0ucGF0aCkudG9Db250YWluKCd0eXBlJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgYWNjZXB0IGFsbCBzdXBwb3J0ZWQgZmlsZSB0eXBlcycsICgpID0+IHtcclxuICAgICAgY29uc3Qgc3VwcG9ydGVkVHlwZXMgPSBbXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3BkZicsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC53b3JkcHJvY2Vzc2luZ21sLmRvY3VtZW50JyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQnLFxyXG4gICAgICAgICd0ZXh0L3BsYWluJyxcclxuICAgICAgICAnaW1hZ2UvcG5nJyxcclxuICAgICAgICAnaW1hZ2UvanBlZydcclxuICAgICAgXTtcclxuXHJcbiAgICAgIHN1cHBvcnRlZFR5cGVzLmZvckVhY2godHlwZSA9PiB7XHJcbiAgICAgICAgY29uc3QgbW9ja0ZpbGUgPSBuZXcgRmlsZShbJ3Rlc3QgY29udGVudCddLCAndGVzdC5maWxlJywgeyB0eXBlIH0pO1xyXG4gICAgICAgIGNvbnN0IHZhbGlkVXBsb2FkID0ge1xyXG4gICAgICAgICAgbmFtZTogJ3Rlc3QuZmlsZScsXHJcbiAgICAgICAgICBzaXplOiAxMDI0LFxyXG4gICAgICAgICAgdHlwZTogdHlwZSBhcyBhbnksXHJcbiAgICAgICAgICBjb250ZW50OiBtb2NrRmlsZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbGVVcGxvYWRTY2hlbWEuc2FmZVBhcnNlKHZhbGlkVXBsb2FkKTtcclxuICAgICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdhcGlSZXF1ZXN0U2NoZW1hJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhIHZhbGlkIEFQSSByZXF1ZXN0JywgKCkgPT4ge1xyXG4gICAgICBjb25zdCB2YWxpZFJlcXVlc3QgPSB7XHJcbiAgICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgY29udGVudDogJ0hlbGxvJyxcclxuICAgICAgICAgICAgcm9sZTogJ3VzZXInIGFzIGNvbnN0XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBjb250ZW50OiAnSGkgdGhlcmUhJyxcclxuICAgICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcgYXMgY29uc3RcclxuICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIG1vZGVsOiAnZ3B0LTQnLFxyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXHJcbiAgICAgICAgbWF4VG9rZW5zOiAxMDAwXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhcGlSZXF1ZXN0U2NoZW1hLnNhZmVQYXJzZSh2YWxpZFJlcXVlc3QpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIG1pbmltYWwgQVBJIHJlcXVlc3QnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG1pbmltYWxSZXF1ZXN0ID0ge1xyXG4gICAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQ6ICdIZWxsbycsXHJcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyBhcyBjb25zdFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIF1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGFwaVJlcXVlc3RTY2hlbWEuc2FmZVBhcnNlKG1pbmltYWxSZXF1ZXN0KTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgZW1wdHkgbWVzc2FnZXMgYXJyYXknLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGludmFsaWRSZXF1ZXN0ID0ge1xyXG4gICAgICAgIG1lc3NhZ2VzOiBbXVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXBpUmVxdWVzdFNjaGVtYS5zYWZlUGFyc2UoaW52YWxpZFJlcXVlc3QpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5pc3N1ZXNbMF0ucGF0aCkudG9Db250YWluKCdtZXNzYWdlcycpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJlamVjdCBpbnZhbGlkIHRlbXBlcmF0dXJlJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBpbnZhbGlkUmVxdWVzdCA9IHtcclxuICAgICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBjb250ZW50OiAnSGVsbG8nLFxyXG4gICAgICAgICAgICByb2xlOiAndXNlcicgYXMgY29uc3RcclxuICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAzLjAgLy8gVG9vIGhpZ2hcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGFwaVJlcXVlc3RTY2hlbWEuc2FmZVBhcnNlKGludmFsaWRSZXF1ZXN0KTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcclxuICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuaXNzdWVzWzBdLnBhdGgpLnRvQ29udGFpbigndGVtcGVyYXR1cmUnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgbmVnYXRpdmUgdGVtcGVyYXR1cmUnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGludmFsaWRSZXF1ZXN0ID0ge1xyXG4gICAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQ6ICdIZWxsbycsXHJcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyBhcyBjb25zdFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgdGVtcGVyYXR1cmU6IC0wLjFcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGFwaVJlcXVlc3RTY2hlbWEuc2FmZVBhcnNlKGludmFsaWRSZXF1ZXN0KTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcclxuICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuaXNzdWVzWzBdLnBhdGgpLnRvQ29udGFpbigndGVtcGVyYXR1cmUnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgaW52YWxpZCBtYXhUb2tlbnMnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGludmFsaWRSZXF1ZXN0ID0ge1xyXG4gICAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQ6ICdIZWxsbycsXHJcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyBhcyBjb25zdFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgbWF4VG9rZW5zOiAwIC8vIFRvbyBsb3dcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGFwaVJlcXVlc3RTY2hlbWEuc2FmZVBhcnNlKGludmFsaWRSZXF1ZXN0KTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcclxuICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuaXNzdWVzWzBdLnBhdGgpLnRvQ29udGFpbignbWF4VG9rZW5zJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmVqZWN0IG1heFRva2VucyB0aGF0IGlzIHRvbyBoaWdoJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBpbnZhbGlkUmVxdWVzdCA9IHtcclxuICAgICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBjb250ZW50OiAnSGVsbG8nLFxyXG4gICAgICAgICAgICByb2xlOiAndXNlcicgYXMgY29uc3RcclxuICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIG1heFRva2VuczogMTAwMDAxIC8vIFRvbyBoaWdoXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhcGlSZXF1ZXN0U2NoZW1hLnNhZmVQYXJzZShpbnZhbGlkUmVxdWVzdCk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XHJcbiAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9yLmlzc3Vlc1swXS5wYXRoKS50b0NvbnRhaW4oJ21heFRva2VucycpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ3Nhbml0aXplSW5wdXQnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJlbW92ZSBIVE1MIHRhZ3MnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGlucHV0ID0gJzxzY3JpcHQ+YWxlcnQoXCJ4c3NcIik8L3NjcmlwdD5IZWxsbyB3b3JsZCc7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNhbml0aXplSW5wdXQoaW5wdXQpO1xyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdzY3JpcHRhbGVydChcInhzc1wiKS9zY3JpcHRIZWxsbyB3b3JsZCcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZW1vdmUgamF2YXNjcmlwdCBwcm90b2NvbCcsICgpID0+IHtcclxuICAgICAgY29uc3QgaW5wdXQgPSAnamF2YXNjcmlwdDphbGVydChcInhzc1wiKSc7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNhbml0aXplSW5wdXQoaW5wdXQpO1xyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdhbGVydChcInhzc1wiKScpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZW1vdmUgZXZlbnQgaGFuZGxlcnMnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGlucHV0ID0gJ29uY2xpY2s9YWxlcnQoXCJ4c3NcIikgb25sb2FkPWFsZXJ0KFwieHNzXCIpJztcclxuICAgICAgY29uc3QgcmVzdWx0ID0gc2FuaXRpemVJbnB1dChpbnB1dCk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ2FsZXJ0KFwieHNzXCIpIGFsZXJ0KFwieHNzXCIpJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHRyaW0gd2hpdGVzcGFjZScsICgpID0+IHtcclxuICAgICAgY29uc3QgaW5wdXQgPSAnICBIZWxsbyB3b3JsZCAgJztcclxuICAgICAgY29uc3QgcmVzdWx0ID0gc2FuaXRpemVJbnB1dChpbnB1dCk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ0hlbGxvIHdvcmxkJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBzdHJpbmcnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGlucHV0ID0gJyc7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNhbml0aXplSW5wdXQoaW5wdXQpO1xyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCcnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHN0cmluZyB3aXRoIG9ubHkgd2hpdGVzcGFjZScsICgpID0+IHtcclxuICAgICAgY29uc3QgaW5wdXQgPSAnICAgXFxuXFx0ICAnO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBzYW5pdGl6ZUlucHV0KGlucHV0KTtcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIG5vcm1hbCB0ZXh0JywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBpbnB1dCA9ICdUaGlzIGlzIG5vcm1hbCB0ZXh0IHdpdGggbnVtYmVycyAxMjMgYW5kIHN5bWJvbHMgQCMkJSc7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNhbml0aXplSW5wdXQoaW5wdXQpO1xyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdUaGlzIGlzIG5vcm1hbCB0ZXh0IHdpdGggbnVtYmVycyAxMjMgYW5kIHN5bWJvbHMgQCMkJScpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxleCBYU1MgYXR0ZW1wdHMnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGlucHV0ID0gJzxpbWcgc3JjPVwieFwiIG9uZXJyb3I9XCJhbGVydChcXCd4c3NcXCcpXCI+amF2YXNjcmlwdDphbGVydChcInhzc1wiKTxzY3JpcHQ+YWxlcnQoXCJ4c3NcIik8L3NjcmlwdD4nO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBzYW5pdGl6ZUlucHV0KGlucHV0KTtcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnaW1nIHNyYz1cInhcIiBcImFsZXJ0KFxcJ3hzc1xcJylcImFsZXJ0KFwieHNzXCIpc2NyaXB0YWxlcnQoXCJ4c3NcIikvc2NyaXB0Jyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJ2ZXJzaW9uIjozfQ==