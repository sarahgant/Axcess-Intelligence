{"version":3,"names":["isDisabled","require","isElementType","isVisible","selector","getTabDestination","activeElement","shift","document","ownerDocument","focusableElements","querySelectorAll","FOCUSABLE_SELECTOR","enabledElements","Array","from","filter","el","Number","getAttribute","sort","a","b","i","j","checkedRadio","prunedElements","body","activeRadioGroup","type","name","undefined","forEach","currentElement","push","checked","e","index","findIndex","length","exports"],"sources":["getTabDestination.js"],"sourcesContent":["'use strict';\n\nvar isDisabled = require('../misc/isDisabled.js');\nvar isElementType = require('../misc/isElementType.js');\nvar isVisible = require('../misc/isVisible.js');\nvar selector = require('./selector.js');\n\nfunction getTabDestination(activeElement, shift) {\n    const document = activeElement.ownerDocument;\n    const focusableElements = document.querySelectorAll(selector.FOCUSABLE_SELECTOR);\n    const enabledElements = Array.from(focusableElements).filter((el)=>el === activeElement || !(Number(el.getAttribute('tabindex')) < 0 || isDisabled.isDisabled(el)));\n    // tabindex has no effect if the active element has negative tabindex\n    if (Number(activeElement.getAttribute('tabindex')) >= 0) {\n        enabledElements.sort((a, b)=>{\n            const i = Number(a.getAttribute('tabindex'));\n            const j = Number(b.getAttribute('tabindex'));\n            if (i === j) {\n                return 0;\n            } else if (i === 0) {\n                return 1;\n            } else if (j === 0) {\n                return -1;\n            }\n            return i - j;\n        });\n    }\n    const checkedRadio = {};\n    let prunedElements = [\n        document.body\n    ];\n    const activeRadioGroup = isElementType.isElementType(activeElement, 'input', {\n        type: 'radio'\n    }) ? activeElement.name : undefined;\n    enabledElements.forEach((currentElement)=>{\n        const el = currentElement;\n        // For radio groups keep only the active radio\n        // If there is no active radio, keep only the checked radio\n        // If there is no checked radio, treat like everything else\n        if (isElementType.isElementType(el, 'input', {\n            type: 'radio'\n        }) && el.name) {\n            // If the active element is part of the group, add only that\n            if (el === activeElement) {\n                prunedElements.push(el);\n                return;\n            } else if (el.name === activeRadioGroup) {\n                return;\n            }\n            // If we stumble upon a checked radio, remove the others\n            if (el.checked) {\n                prunedElements = prunedElements.filter((e)=>!isElementType.isElementType(e, 'input', {\n                        type: 'radio',\n                        name: el.name\n                    }));\n                prunedElements.push(el);\n                checkedRadio[el.name] = el;\n                return;\n            }\n            // If we already found the checked one, skip\n            if (typeof checkedRadio[el.name] !== 'undefined') {\n                return;\n            }\n        }\n        prunedElements.push(el);\n    });\n    for(let index = prunedElements.findIndex((el)=>el === activeElement);;){\n        index += shift ? -1 : 1;\n        // loop at overflow\n        if (index === prunedElements.length) {\n            index = 0;\n        } else if (index === -1) {\n            index = prunedElements.length - 1;\n        }\n        if (prunedElements[index] === activeElement || prunedElements[index] === document.body || isVisible.isVisible(prunedElements[index])) {\n            return prunedElements[index];\n        }\n    }\n}\n\nexports.getTabDestination = getTabDestination;\n"],"mappings":"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","ignoreList":[]}